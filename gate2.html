<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AtlasNexus Institutional Portal | Professional Access</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iNyIgeT0iMTMiIHdpZHRoPSIxOCIgaGVpZ2h0PSIxNSIgcng9IjMiIGZpbGw9IiNmZmZmZmYiIHN0cm9rZT0iIzMzMzMzMyIgc3Ryb2tlLXdpZHRoPSIyIi8+CjxjaXJjbGUgY3g9IjE2IiBjeT0iMjAuNSIgcj0iMiIgZmlsbD0iIzMzMzMzMyIvPgo8cGF0aCBkPSJNMTEgOSBDMTEgNS4xMyAxMy4xMyAzIDE3IDMgQzIwLjg3IDMgMjMgNS4xMyAyMyA5IFYxMyBIMjAgVjkgQzIwIDYuNzkgMTguMjEgNSAxNiA1IEMxMy43OSA1IDEyIDYuNzkgMTIgOSBWMTMgSDkgVjkgWiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIuNSIvPgo8L3N2Zz4K" />
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700;800&family=SF+Pro+Text:wght@400;500;600&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Address Autocomplete - FREE using OpenStreetMap -->
    <script>
        // Address autocomplete using free Nominatim API (OpenStreetMap)
        let currentFocus = -1;
        
        function setupAddressAutocomplete() {
            // Personal address autocomplete
            const personalStreetInput = document.getElementById('personal_street_autocomplete');
            if (personalStreetInput) {
                setupAutocomplete(personalStreetInput, 'personal');
                console.log('Personal address autocomplete initialized');
            } else {
                console.log('Personal street input not found');
            }
            
            // Business address autocomplete  
            const businessStreetInput = document.getElementById('business_street_autocomplete');
            if (businessStreetInput) {
                setupAutocomplete(businessStreetInput, 'business');
                console.log('Business address autocomplete initialized');
            } else {
                console.log('Business street input not found');
            }
        }
        
        function setupAutocomplete(input, type) {
            let searchTimeout;
            let suggestionsContainer;
            
            // Create suggestions container
            const container = document.createElement('div');
            container.className = 'address-suggestions';
            container.style.cssText = `
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(44, 49, 55, 0.98);
                border: 1px solid rgba(212, 175, 55, 0.3);
                border-radius: 0 0 var(--radius-medium) var(--radius-medium);
                max-height: 200px;
                overflow-y: auto;
                z-index: 1000;
                display: none;
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
                backdrop-filter: blur(12px);
            `;
            
            // Make parent relative
            input.parentElement.style.position = 'relative';
            input.parentElement.appendChild(container);
            suggestionsContainer = container;
            
            input.addEventListener('input', function(e) {
                const query = e.target.value.trim();
                
                clearTimeout(searchTimeout);
                
                if (query.length < 3) {
                    hideSuggestions();
                    return;
                }
                
                // Debounce search
                searchTimeout = setTimeout(() => {
                    searchAddresses(query, suggestionsContainer, input, type);
                }, 300);
            });
            
            // Hide suggestions when clicking outside
            document.addEventListener('click', function(e) {
                if (!input.contains(e.target) && !suggestionsContainer.contains(e.target)) {
                    hideSuggestions();
                }
            });
            
            // Keyboard navigation
            input.addEventListener('keydown', function(e) {
                const suggestions = suggestionsContainer.querySelectorAll('.suggestion-item');
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    currentFocus = Math.min(currentFocus + 1, suggestions.length - 1);
                    updateFocus(suggestions);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    currentFocus = Math.max(currentFocus - 1, -1);
                    updateFocus(suggestions);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (currentFocus >= 0 && suggestions[currentFocus]) {
                        suggestions[currentFocus].click();
                    }
                } else if (e.key === 'Escape') {
                    hideSuggestions();
                }
            });
            
            function hideSuggestions() {
                suggestionsContainer.style.display = 'none';
                currentFocus = -1;
            }
            
            function updateFocus(suggestions) {
                suggestions.forEach((item, index) => {
                    if (index === currentFocus) {
                        item.style.backgroundColor = 'rgba(212, 175, 55, 0.2)';
                        item.style.borderColor = 'rgba(212, 175, 55, 0.5)';
                    } else {
                        item.style.backgroundColor = '';
                        item.style.borderColor = 'rgba(184, 192, 200, 0.2)';
                    }
                });
            }
        }
        
        async function searchAddresses(query, container, input, type) {
            try {
                // Use UK-focused search with bias
                const url = `https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&limit=5&countrycodes=gb&q=${encodeURIComponent(query + ', UK')}`;
                
                const response = await fetch(url, {
                    headers: {
                        'User-Agent': 'AtlasNexus Address Autocomplete'
                    }
                });
                
                if (!response.ok) {
                    throw new Error('Search failed');
                }
                
                const results = await response.json();
                
                displaySuggestions(results, container, input, type);
                
            } catch (error) {
                console.log('Address search error:', error);
                // Fallback to basic input
                container.style.display = 'none';
            }
        }
        
        function displaySuggestions(results, container, input, type) {
            container.innerHTML = '';
            
            if (results.length === 0) {
                container.style.display = 'none';
                return;
            }
            
            results.forEach((result, index) => {
                const item = document.createElement('div');
                item.className = 'suggestion-item';
                item.style.cssText = `
                    padding: 12px 16px;
                    cursor: pointer;
                    border-bottom: 1px solid rgba(184, 192, 200, 0.2);
                    font-size: 0.9rem;
                    color: var(--pure-white);
                    transition: all 0.2s ease;
                `;
                
                // Format address nicely
                const address = result.display_name.split(',');
                const street = address[0];
                const area = address.slice(1, 3).join(',');
                
                item.innerHTML = `
                    <div style="font-weight: 600;">${street}</div>
                    <div style="font-size: 0.8rem; color: var(--silver-mist); margin-top: 2px;">${area}</div>
                `;
                
                item.addEventListener('mouseenter', () => {
                    currentFocus = index;
                    const suggestions = container.querySelectorAll('.suggestion-item');
                    updateFocus(suggestions);
                });
                
                item.addEventListener('click', () => {
                    selectAddress(result, input, type);
                    container.style.display = 'none';
                });
                
                container.appendChild(item);
            });
            
            container.style.display = 'block';
            currentFocus = -1;
        }
        
        function selectAddress(addressData, input, type) {
            // Build complete street address from components
            const address = addressData.address || {};
            let streetAddress = '';
            
            // Build street address properly
            const houseNumber = address.house_number || '';
            const road = address.road || address.street || '';
            
            if (houseNumber && road) {
                streetAddress = `${houseNumber} ${road}`;
            } else if (road) {
                streetAddress = road;
            } else {
                // Fallback to first part of display_name
                streetAddress = addressData.display_name.split(',')[0];
            }
            
            // Fill in the street address
            input.value = streetAddress;
            
            // Auto-fill other fields based on the address components
            
            // Determine field prefixes
            const prefix = type === 'personal' ? 'personal' : 'business';
            
            // Fill city
            const cityField = document.querySelector(`input[name="${prefix}_city"]`);
            if (cityField) {
                cityField.value = address.city || address.town || address.village || address.county || '';
            }
            
            // Fill postcode
            const postcodeField = document.querySelector(`input[name="${prefix}_postcode"]`);
            if (postcodeField) {
                postcodeField.value = address.postcode || '';
            }
            
            // Fill country
            const countryField = document.querySelector(`select[name="${prefix}_country"]`);
            if (countryField && address.country) {
                // Map country codes to full names
                const countryMap = {
                    'United Kingdom': 'United Kingdom',
                    'England': 'United Kingdom',
                    'Scotland': 'United Kingdom', 
                    'Wales': 'United Kingdom',
                    'Northern Ireland': 'United Kingdom',
                    'Ireland': 'Ireland',
                    'France': 'France',
                    'Germany': 'Germany',
                    'Netherlands': 'Netherlands',
                    'Switzerland': 'Switzerland'
                };
                
                const country = countryMap[address.country] || address.country;
                
                // Try to select the country
                for (let option of countryField.options) {
                    if (option.value === country) {
                        countryField.value = country;
                        break;
                    }
                }
            }
            
            // Trigger change events
            [cityField, postcodeField, countryField].forEach(field => {
                if (field) {
                    field.dispatchEvent(new Event('change', { bubbles: true }));
                }
            });
        }
        
        function updateFocus(suggestions) {
            suggestions.forEach((item, index) => {
                if (index === currentFocus) {
                    item.style.backgroundColor = 'rgba(212, 175, 55, 0.2)';
                    item.style.borderColor = 'rgba(212, 175, 55, 0.5)';
                } else {
                    item.style.backgroundColor = '';
                    item.style.borderColor = 'rgba(184, 192, 200, 0.2)';
                }
            });
        }
    </script>
    
    <style>
        :root {
            /* Modern Financial Institution Palette */
            --deep-charcoal: #1A1D23;
            --slate-grey: #2C3137;
            --steel-blue: #364049;
            --carbon-grey: #4A525A;
            --silver-mist: #7D8590;
            --pearl-grey: #B8C0C8;
            --pure-white: #FFFFFF;
            --ice-white: #F7F9FB;
            
            /* Sophisticated Accent Colors */
            --platinum-gold: #D4AF37;
            --royal-blue: #1E3A8A;
            --crimson-red: #B91C1C;
            --emerald-green: #059669;
            --amber-yellow: #F59E0B;
            --market-red: #EF4444;
            --market-green: #10B981;
            
            /* Typography Hierarchy */
            --font-display: 'SF Pro Display', system-ui, -apple-system, sans-serif;
            --font-text: 'SF Pro Text', system-ui, -apple-system, sans-serif;
            --font-mono: 'JetBrains Mono', 'Monaco', 'Menlo', monospace;
            
            /* Institutional Spacing Scale */
            --space-1: 0.25rem;   /* 4px */
            --space-2: 0.5rem;    /* 8px */
            --space-3: 0.75rem;   /* 12px */
            --space-4: 1rem;      /* 16px */
            --space-5: 1.25rem;   /* 20px */
            --space-6: 1.5rem;    /* 24px */
            --space-8: 2rem;      /* 32px */
            --space-10: 2.5rem;   /* 40px */
            --space-12: 3rem;     /* 48px */
            --space-16: 4rem;     /* 64px */
            --space-20: 5rem;     /* 80px */
            
            /* Professional Elevation */
            --shadow-subtle: 0 1px 3px rgba(11, 20, 38, 0.08);
            --shadow-medium: 0 4px 12px rgba(11, 20, 38, 0.12);
            --shadow-strong: 0 8px 24px rgba(11, 20, 38, 0.16);
            --shadow-executive: 0 16px 48px rgba(11, 20, 38, 0.24);
            
            /* Border Precision */
            --radius-tight: 0.125rem;
            --radius-standard: 0.25rem;
            --radius-medium: 0.375rem;
            --radius-large: 0.5rem;
            --radius-executive: 0.75rem;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }
        
        body {
            font-family: var(--font-text);
            background: var(--deep-charcoal);
            color: var(--pearl-grey);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }
        
        /* Clean Professional Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--deep-charcoal) 0%, var(--slate-grey) 100%);
            z-index: -2;
        }
        
        /* Subtle Grid Pattern */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(212, 175, 55, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(212, 175, 55, 0.02) 1px, transparent 1px);
            background-size: 40px 40px;
            z-index: -1;
            opacity: 0.8;
        }

        /* Bloomberg-Style Financial Ticker */
        .financial-ticker {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 52px;
            background: linear-gradient(135deg, var(--steel-blue) 0%, var(--slate-grey) 100%);
            border-bottom: 2px solid var(--platinum-gold);
            z-index: 1000;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        .ticker-container {
            display: flex;
            align-items: center;
            height: 100%;
            white-space: nowrap;
            animation: ticker-scroll 1800s linear infinite;
            width: max-content;
            cursor: grab;
            user-select: none;
            will-change: transform;
            backface-visibility: hidden;
            transform: translateZ(0);
        }
        
        .ticker-container:active {
            cursor: grabbing;
        }
        
        .ticker-container.dragging {
            animation-play-state: paused;
            transition: none;
        }
        
        @keyframes ticker-scroll {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-100%, 0, 0); }
        }
        
        .ticker-item {
            display: inline-flex;
            align-items: center;
            margin-right: var(--space-8);
            font-family: var(--font-mono);
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .ticker-symbol {
            color: var(--platinum-gold);
            font-weight: 600;
            font-size: inherit;
        }
        
        .ticker-value {
            color: var(--pure-white);
            font-size: inherit;
        }
        
        .ticker-change {
            font-size: inherit;
        }
        
        .ticker-item.positive { color: var(--market-green); }
        .ticker-item.negative { color: var(--market-red); }
        .ticker-item.neutral { color: var(--amber-yellow); }
        
        .ticker-timeframe {
            color: var(--silver-mist);
            font-size: inherit;
        }
        
        .ticker-separator {
            color: var(--platinum-gold);
            margin: 0 var(--space-3);
            font-weight: bold;
        }
        
        .ticker-section-header {
            color: var(--platinum-gold);
            font-weight: 800;
            font-size: 1.3rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-right: var(--space-6);
            padding: 0 var(--space-4);
            border-left: 3px solid var(--platinum-gold);
            border-right: 3px solid var(--platinum-gold);
        }
        
        /* Institutional Container Authority */
        .institutional-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space-6);
            position: relative;
            z-index: 1;
            margin-top: 44px; /* Account for fixed ticker */
        }
        
        /* Toolkit Navigation Header */
        .toolkit-navigation {
            background: linear-gradient(135deg, var(--steel-blue) 0%, var(--slate-grey) 100%);
            border-bottom: 3px solid var(--platinum-gold);
            margin-bottom: var(--space-8);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            position: relative;
            z-index: 999;
        }
        
        .toolkit-navigation.hidden {
            transform: translateY(-100%);
            margin-bottom: 0;
        }
        
        .toolkit-header {
            padding: var(--space-6) var(--space-8);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .toolkit-branding {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }
        
        .toolkit-logo {
            width: 32px;
            height: 32px;
        }
        
        .toolkit-title {
            font-family: var(--font-display);
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--pure-white);
            margin: 0;
            letter-spacing: -0.02em;
        }
        
        .nav-controls {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }
        
        .hide-nav-btn {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid var(--platinum-gold);
            color: var(--platinum-gold);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-medium);
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .hide-nav-btn:hover {
            background: rgba(212, 175, 55, 0.4);
            transform: translateY(-1px);
        }
        
        .toolkit-nav {
            padding: var(--space-4) var(--space-8);
            display: flex;
            align-items: center;
            gap: var(--space-8);
            flex-wrap: wrap;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-family: var(--font-text);
            font-size: 0.95rem;
            font-weight: 500;
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-medium);
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .nav-link:hover {
            color: var(--pure-white);
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(212, 175, 55, 0.3);
            transform: translateY(-1px);
        }
        
        .nav-link.active {
            color: var(--platinum-gold);
            background: rgba(212, 175, 55, 0.15);
            border-color: var(--platinum-gold);
        }
        
        .nav-link svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }
        
        .user-section {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-2) var(--space-4);
            background: rgba(44, 49, 55, 0.6);
            border-radius: var(--radius-medium);
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
        }
        
        .user-name {
            color: var(--pure-white);
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .password-expiry {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .expiry-text {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.75rem;
        }
        
        .expiry-bar {
            width: 60px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .expiry-progress {
            height: 100%;
            background: linear-gradient(90deg, var(--market-red), var(--amber-yellow), var(--market-green));
            border-radius: 2px;
            transition: width 0.3s ease;
        }
        
        /* Show Navigation Button (when hidden) */
        .show-nav-btn {
            position: fixed;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(212, 175, 55, 0.95);
            color: var(--deep-charcoal);
            border: none;
            padding: var(--space-2) var(--space-4);
            border-radius: 0 0 var(--radius-medium) var(--radius-medium);
            font-size: 0.8rem;
            font-weight: 700;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            opacity: 0;
            visibility: hidden;
        }
        
        .show-nav-btn.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .show-nav-btn:hover {
            background: var(--platinum-gold);
            transform: translateX(-50%) translateY(2px);
        }
        
        /* Floating Help Button */
        .help-button {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--platinum-gold) 0%, #E5C547 100%);
            border: none;
            border-radius: 50%;
            box-shadow: 0 4px 16px rgba(212, 175, 55, 0.4), 0 8px 32px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 1002;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .help-button:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.5), 0 12px 40px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, #FFD700 0%, var(--platinum-gold) 100%);
        }
        
        .help-button svg {
            width: 24px;
            height: 24px;
            fill: var(--deep-charcoal);
        }
        
        .help-tooltip {
            position: fixed;
            bottom: 90px;
            right: 24px;
            background: rgba(44, 49, 55, 0.98);
            backdrop-filter: blur(12px);
            color: var(--pure-white);
            padding: var(--space-4) var(--space-5);
            border-radius: var(--radius-medium);
            border: 1px solid rgba(212, 175, 55, 0.3);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s ease;
            min-width: 280px;
            max-width: 320px;
        }
        
        .help-tooltip.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .help-tooltip::after {
            content: '';
            position: absolute;
            bottom: -8px;
            right: 28px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid rgba(44, 49, 55, 0.98);
        }
        
        .help-content h4 {
            color: var(--platinum-gold);
            font-family: var(--font-display);
            font-size: 1.1rem;
            font-weight: 700;
            margin: 0 0 var(--space-3) 0;
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .help-content h4 svg {
            width: 18px;
            height: 18px;
            fill: var(--platinum-gold);
        }
        
        .help-content p {
            font-size: 0.9rem;
            line-height: 1.5;
            margin: 0 0 var(--space-3) 0;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .support-info {
            background: rgba(212, 175, 55, 0.1);
            padding: var(--space-3);
            border-radius: var(--radius-small);
            border: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .support-email {
            color: var(--platinum-gold);
            font-weight: 600;
            text-decoration: none;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: var(--space-2);
            transition: all 0.3s ease;
        }
        
        .support-email:hover {
            color: #FFD700;
            text-decoration: underline;
        }
        
        .support-email svg {
            width: 14px;
            height: 14px;
            fill: currentColor;
        }
        
        /* Mobile Help Button */
        @media (max-width: 768px) {
            .help-button {
                bottom: 20px;
                right: 20px;
                width: 48px;
                height: 48px;
            }
            
            .help-button svg {
                width: 20px;
                height: 20px;
            }
            
            .help-tooltip {
                bottom: 80px;
                right: 20px;
                left: 20px;
                min-width: auto;
                max-width: none;
            }
            
            .help-tooltip::after {
                right: 24px;
            }
        }
        
        /* Market Login Overlay Modal */
        .market-login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: overlayFadeIn 0.3s ease;
        }
        
        .market-login-modal {
            background: linear-gradient(135deg, var(--deep-charcoal) 0%, var(--slate-grey) 100%);
            border-radius: var(--radius-large);
            border: 1px solid rgba(212, 175, 55, 0.3);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow: hidden;
            animation: modalSlideIn 0.3s ease;
        }
        
        .modal-header {
            padding: var(--space-6);
            border-bottom: 1px solid rgba(184, 192, 200, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, transparent 100%);
        }
        
        .modal-header h3 {
            color: var(--platinum-gold);
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0;
        }
        
        .close-modal {
            color: var(--silver-light);
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            line-height: 1;
            padding: 0 var(--space-2);
        }
        
        .close-modal:hover {
            color: var(--platinum-gold);
            transform: scale(1.1);
        }
        
        .modal-content {
            padding: var(--space-6);
        }
        
        .premium-features h4 {
            color: var(--pure-white);
            font-size: 1.25rem;
            font-weight: 600;
            margin: 0 0 var(--space-4) 0;
        }
        
        .premium-features ul {
            list-style: none;
            padding: 0;
            margin: 0 0 var(--space-6) 0;
        }
        
        .premium-features li {
            color: var(--silver-light);
            padding: var(--space-2) 0;
            font-size: 0.95rem;
            border-bottom: 1px solid rgba(184, 192, 200, 0.1);
        }
        
        .premium-features li:last-child {
            border-bottom: none;
        }
        
        .modal-actions {
            display: flex;
            gap: var(--space-3);
            flex-direction: column;
        }
        
        .premium-login-btn {
            background: linear-gradient(135deg, var(--platinum-gold) 0%, #E5C547 100%);
            color: var(--deep-charcoal);
            border: none;
            padding: var(--space-4) var(--space-6);
            border-radius: var(--radius-medium);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(212, 175, 55, 0.3);
        }
        
        .premium-login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
            background: linear-gradient(135deg, #FFD700 0%, var(--platinum-gold) 100%);
        }
        
        .modal-close-btn {
            background: transparent;
            color: var(--silver-light);
            border: 1px solid rgba(184, 192, 200, 0.3);
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-medium);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .modal-close-btn:hover {
            border-color: var(--platinum-gold);
            color: var(--platinum-gold);
            background: rgba(212, 175, 55, 0.1);
        }
        
        @keyframes overlayFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes modalSlideIn {
            from { 
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to { 
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @media (max-width: 768px) {
            .market-login-modal {
                width: 95%;
                max-width: none;
            }
            
            .modal-header {
                padding: var(--space-4);
            }
            
            .modal-content {
                padding: var(--space-4);
            }
            
            .modal-actions {
                gap: var(--space-2);
            }
        }
        
        /* Market Intelligence Preview Section */
        .market-preview {
            background: linear-gradient(135deg, rgba(44, 49, 55, 0.95) 0%, rgba(54, 64, 73, 0.95) 100%);
            backdrop-filter: blur(24px);
            border: 1px solid rgba(212, 175, 55, 0.25);
            border-radius: var(--radius-executive);
            padding: var(--space-6) var(--space-8);
            margin: var(--space-8) 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        
        .market-preview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent 0%, var(--platinum-gold) 50%, transparent 100%);
        }
        
        .market-preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-4);
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .market-preview-title {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }
        
        .market-preview-title h3 {
            color: var(--platinum-gold);
            font-family: var(--font-display);
            font-size: 1.3rem;
            font-weight: 700;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .market-preview-title svg {
            width: 20px;
            height: 20px;
            fill: var(--platinum-gold);
        }
        
        .market-status {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--market-green);
            animation: pulse 2s infinite;
        }
        
        .status-indicator.closed {
            background: var(--market-red);
            animation: none;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .market-preview-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: var(--space-6);
            margin-bottom: var(--space-6);
        }
        
        .market-widget {
            background: rgba(74, 82, 90, 0.4);
            border: 1px solid rgba(184, 192, 200, 0.2);
            border-radius: var(--radius-medium);
            padding: var(--space-4);
            transition: all 0.3s ease;
        }
        
        .market-widget:hover {
            background: rgba(74, 82, 90, 0.6);
            border-color: rgba(212, 175, 55, 0.3);
            transform: translateY(-2px);
        }
        
        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-3);
        }
        
        .widget-title {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.85rem;
            font-weight: 600;
            margin: 0;
        }
        
        .widget-change {
            font-size: 0.75rem;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .widget-change.positive {
            color: var(--market-green);
            background: rgba(34, 197, 94, 0.15);
        }
        
        .widget-change.negative {
            color: var(--market-red);
            background: rgba(239, 68, 68, 0.15);
        }
        
        .widget-value {
            color: var(--pure-white);
            font-size: 1.4rem;
            font-weight: 700;
            font-family: var(--font-mono);
            margin: 0;
        }
        
        .daily-insights {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: var(--radius-medium);
            padding: var(--space-4);
            margin-bottom: var(--space-6);
        }
        
        .insights-title {
            color: var(--platinum-gold);
            font-size: 0.9rem;
            font-weight: 700;
            margin: 0 0 var(--space-3) 0;
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .insights-title svg {
            width: 14px;
            height: 14px;
            fill: var(--platinum-gold);
        }
        
        .insights-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.85rem;
            line-height: 1.5;
            margin: 0;
        }
        
        .login-prompt {
            text-align: center;
            padding: var(--space-4);
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: var(--radius-medium);
        }
        
        .login-prompt-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            margin: 0 0 var(--space-3) 0;
        }
        
        .access-full-markets {
            background: linear-gradient(135deg, var(--platinum-gold) 0%, #E5C547 100%);
            color: var(--deep-charcoal);
            border: none;
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-medium);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .access-full-markets:hover {
            background: linear-gradient(135deg, #FFD700 0%, var(--platinum-gold) 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }
        
        /* Mobile Market Preview */
        @media (max-width: 768px) {
            .market-preview {
                padding: var(--space-4) var(--space-5);
                margin: var(--space-6) 0;
            }
            
            .market-preview-header {
                flex-direction: column;
                gap: var(--space-3);
                text-align: center;
            }
            
            .market-preview-grid {
                grid-template-columns: 1fr;
                gap: var(--space-4);
            }
            
            .market-preview-title h3 {
                font-size: 1.1rem;
            }
        }
        
        .corporate-identity {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-5);
            margin-bottom: var(--space-6);
        }
        
        .corporate-identity {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-4);
        }
        
        .logo-with-globe {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            position: relative;
        }
        
        .atlas-text {
            font-family: var(--font-display);
            font-size: 4.5rem;
            font-weight: 800;
            color: var(--pure-white);
            letter-spacing: -0.02em;
            margin: 0;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .globe-center {
            width: 90px;
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 var(--space-1);
        }
        
        .globe-center svg {
            width: 82px;
            height: 82px;
        }
        
        .nexus-text {
            font-family: var(--font-display);
            font-size: 4.5rem;
            font-weight: 800;
            color: var(--pure-white);
            letter-spacing: -0.02em;
            margin: 0;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .institutional-tagline {
            font-family: var(--font-text);
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--ice-white);
            margin-bottom: var(--space-5);
            letter-spacing: 0.02em;
            opacity: 0.95;
        }
        
        .security-classification {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            background: linear-gradient(135deg, var(--royal-blue) 0%, var(--crimson-red) 100%);
            color: var(--pure-white);
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-large);
            font-family: var(--font-text);
            font-size: 0.875rem;
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            box-shadow: 0 3px 12px rgba(30, 58, 138, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .security-classification::before {
            content: '🔒';
            font-size: 0.8rem;
        }
        
        /* Market Intelligence Command Centre */
        .market-intelligence {
            background: linear-gradient(135deg, rgba(44, 49, 55, 0.95) 0%, rgba(54, 64, 73, 0.95) 100%);
            backdrop-filter: blur(24px);
            border: 1px solid rgba(212, 175, 55, 0.25);
            border-radius: var(--radius-executive);
            padding: var(--space-8);
            margin-bottom: var(--space-16);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        
        .market-intelligence::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent 0%, var(--platinum-gold) 50%, transparent 100%);
        }
        
        .intelligence-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-4);
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .intelligence-title {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--pure-white);
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }
        
        .market-timestamp {
            font-family: var(--font-mono);
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--platinum-gold);
            background: rgba(212, 175, 55, 0.15);
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-medium);
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .market-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--space-4);
        }
        
        .market-instrument {
            background: rgba(74, 82, 90, 0.3);
            border: 1px solid rgba(184, 192, 200, 0.2);
            border-radius: var(--radius-medium);
            padding: var(--space-4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .market-instrument:hover {
            background: rgba(74, 82, 90, 0.5);
            border-color: rgba(212, 175, 55, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(212, 175, 55, 0.1);
        }
        
        .instrument-label {
            font-family: var(--font-text);
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--silver-mist);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: var(--space-1);
        }
        
        .instrument-value {
            font-family: var(--font-mono);
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--pure-white);
            margin-bottom: var(--space-1);
            line-height: 1.2;
        }
        
        .instrument-change {
            font-family: var(--font-mono);
            font-size: 0.7rem;
            font-weight: 500;
            display: flex;
            gap: var(--space-2);
        }
        
        .change-24h, .change-7d {
            font-size: 0.65rem;
        }
        
        .change-positive { color: var(--market-green); }
        .change-negative { color: var(--market-red); }
        .change-neutral { color: var(--amber-yellow); }
        
        /* Access Command Portal */
        .access-portal {
            background: linear-gradient(135deg, rgba(44, 49, 55, 0.98) 0%, rgba(54, 64, 73, 0.98) 100%);
            backdrop-filter: blur(24px);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: var(--radius-executive);
            overflow: hidden;
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.25);
            margin-bottom: var(--space-16);
        }
        
        /* Executive Navigation */
        .access-navigation {
            display: flex;
            background: rgba(26, 29, 35, 0.9);
            border-bottom: 1px solid rgba(212, 175, 55, 0.25);
        }
        
        .nav-control {
            flex: 1;
            background: transparent;
            border: none;
            padding: var(--space-6) var(--space-8);
            font-family: var(--font-text);
            font-size: 1rem;
            font-weight: 500;
            color: var(--pearl-grey);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-3);
        }
        
        .nav-control:hover {
            background: rgba(212, 175, 55, 0.1);
            color: var(--pure-white);
        }
        
        .nav-control.active {
            background: var(--platinum-gold);
            color: var(--deep-charcoal);
            font-weight: 600;
        }
        
        .nav-control.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--platinum-gold);
        }
        
        /* Portal Content Authority */
        .portal-content {
            padding: var(--space-12) var(--space-10);
        }
        
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
        }
        
        .section-command {
            text-align: center;
            margin-bottom: var(--space-10);
        }
        
        .command-title {
            font-family: var(--font-display);
            font-size: 1.875rem;
            font-weight: 600;
            color: var(--pure-white);
            margin-bottom: var(--space-3);
            letter-spacing: -0.01em;
        }
        
        .command-subtitle {
            font-family: var(--font-text);
            font-size: 1.125rem;
            color: var(--silver-mist);
            font-weight: 400;
        }
        
        /* Executive Form Controls */
        .form-executive {
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* Form Section Styling */
        .form-section {
            background: rgba(74, 82, 90, 0.15);
            border: 1px solid rgba(184, 192, 200, 0.2);
            border-radius: var(--radius-executive);
            padding: var(--space-8);
            margin-bottom: var(--space-8);
            backdrop-filter: blur(8px);
        }
        
        .section-header {
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-4);
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .section-title {
            font-family: var(--font-display);
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--pure-white);
            display: flex;
            align-items: center;
            gap: var(--space-3);
            margin-bottom: var(--space-2);
        }
        
        .section-title svg {
            color: var(--platinum-gold);
        }
        
        .section-subtitle {
            font-family: var(--font-text);
            font-size: 0.875rem;
            color: var(--silver-mist);
            margin: 0;
            opacity: 0.9;
        }
        
        /* Address Section Styling */
        .address-section {
            background: rgba(26, 29, 35, 0.3);
            border: 1px solid rgba(212, 175, 55, 0.15);
            border-radius: var(--radius-large);
            padding: var(--space-6);
            margin-top: var(--space-6);
        }
        
        .address-title {
            font-family: var(--font-text);
            font-size: 1rem;
            font-weight: 600;
            color: var(--platinum-gold);
            margin-bottom: var(--space-4);
            padding-bottom: var(--space-2);
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .address-grid {
            grid-template-columns: 1fr 140px 160px;
        }
        
        .address-field-full {
            grid-column: 1 / -1;
        }
        
        /* Input Group Styling */
        .input-group {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .input-group .field-select {
            flex-shrink: 0;
            width: 100px;
        }
        
        .input-group .field-input {
            flex: 1;
            margin: 0;
        }
        
        /* Google Places Autocomplete Styling */
        .pac-container {
            background: var(--steel-blue) !important;
            border: 1px solid var(--platinum-gold) !important;
            border-radius: var(--radius-medium) !important;
            box-shadow: var(--shadow-strong) !important;
            z-index: 9999 !important;
        }
        
        .pac-item {
            color: var(--pure-white) !important;
            border-bottom: 1px solid rgba(212, 175, 55, 0.2) !important;
            padding: var(--space-3) var(--space-4) !important;
            font-family: var(--font-text) !important;
        }
        
        .pac-item:hover {
            background: var(--platinum-gold) !important;
            color: var(--deep-charcoal) !important;
        }
        
        .pac-item-selected {
            background: var(--platinum-gold) !important;
            color: var(--deep-charcoal) !important;
        }
        
        .pac-matched {
            font-weight: 600 !important;
        }
        
        .address-field-autocomplete {
            position: relative;
        }
        
        .address-field-autocomplete .field-input {
            padding-right: 40px;
        }
        
        .address-autocomplete-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--platinum-gold);
            font-size: 0.875rem;
            pointer-events: none;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-6);
            margin-bottom: var(--space-6);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-4);
        }
        
        .form-field {
            margin-bottom: var(--space-6);
        }
        
        .field-label {
            display: block;
            font-family: var(--font-text);
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--pure-white);
            margin-bottom: var(--space-3);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .field-input,
        .field-select,
        .field-textarea {
            width: 100%;
            background: rgba(74, 82, 90, 0.6);
            border: 1px solid rgba(184, 192, 200, 0.3);
            border-radius: var(--radius-medium);
            padding: var(--space-4) var(--space-5);
            font-family: var(--font-text);
            font-size: 1rem;
            color: var(--pure-white);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(8px);
        }
        
        .field-input:focus,
        .field-select:focus,
        .field-textarea:focus {
            outline: none;
            border-color: var(--platinum-gold);
            background: rgba(74, 82, 90, 0.8);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
        }
        
        .field-input::placeholder,
        .field-textarea::placeholder {
            color: var(--silver-mist);
            opacity: 0.8;
        }
        
        .field-textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .field-hint {
            font-size: 0.75rem;
            color: var(--silver-mist);
            margin-top: var(--space-2);
            opacity: 0.9;
        }
        
        /* Executive Action Commands */
        .action-command {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-3);
            padding: var(--space-4) var(--space-8);
            font-family: var(--font-text);
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: var(--radius-medium);
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }
        
        .command-primary {
            background: linear-gradient(135deg, var(--platinum-gold) 0%, #E5C547 100%);
            color: var(--deep-charcoal);
            box-shadow: 0 4px 16px rgba(212, 175, 55, 0.3);
        }
        
        .command-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }
        
        .command-secondary {
            background: rgba(74, 82, 90, 0.8);
            color: var(--pure-white);
            border: 1px solid rgba(184, 192, 200, 0.3);
        }
        
        .command-secondary:hover {
            background: rgba(74, 82, 90, 1);
            border-color: var(--platinum-gold);
        }
        
        .command-success {
            background: linear-gradient(135deg, var(--emerald-green) 0%, #10B981 100%);
            color: var(--pure-white);
        }
        
        .command-full {
            width: 100%;
        }
        
        /* Executive Alert System */
        .executive-alert {
            padding: var(--space-5);
            border-radius: var(--radius-medium);
            margin-bottom: var(--space-6);
            border: 1px solid;
            backdrop-filter: blur(8px);
            font-weight: 500;
        }
        
        .alert-success {
            background: rgba(5, 150, 105, 0.15);
            border-color: var(--emerald-green);
            color: var(--emerald-green);
        }
        
        .alert-warning {
            background: rgba(30, 41, 59, 0.95);
            border-color: rgba(71, 85, 105, 0.6);
            color: rgba(147, 197, 253, 1);
            text-align: center;
            padding: var(--space-8);
            border-radius: var(--radius-large);
            backdrop-filter: blur(12px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }
        
        .alert-warning h4 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ffffff;
            text-shadow: 
                -1px -1px 0 #000000,
                1px -1px 0 #000000,
                -1px 1px 0 #000000,
                1px 1px 0 #000000,
                2px 2px 6px rgba(0, 0, 0, 0.9),
                0 0 15px rgba(0, 0, 0, 0.7);
            margin-bottom: var(--space-4);
            letter-spacing: 0.5px;
        }
        
        .alert-warning p {
            font-size: 1.2rem;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.95);
            text-shadow: 
                -1px -1px 0 #000000,
                1px -1px 0 #000000,
                -1px 1px 0 #000000,
                1px 1px 0 #000000,
                2px 2px 4px rgba(0, 0, 0, 0.8),
                0 0 10px rgba(0, 0, 0, 0.6);
            line-height: 1.6;
            margin-bottom: var(--space-3);
        }
        
        .alert-warning p strong {
            color: #ffffff;
            font-weight: 700;
            text-shadow: 
                -1px -1px 0 #000000,
                1px -1px 0 #000000,
                -1px 1px 0 #000000,
                1px 1px 0 #000000,
                2px 2px 6px rgba(0, 0, 0, 0.9),
                0 0 12px rgba(0, 0, 0, 0.7);
        }
        
        .alert-danger {
            background: rgba(185, 28, 28, 0.15);
            border-color: var(--crimson-red);
            color: var(--crimson-red);
        }
        
        /* Verification Command Centre */
        .verification-centre {
            background: rgba(26, 29, 35, 0.8);
            border: 1px solid rgba(212, 175, 55, 0.25);
            border-radius: var(--radius-large);
            padding: var(--space-8);
            margin-top: var(--space-8);
            text-align: center;
        }
        
        .verification-code-field {
            font-family: var(--font-mono);
            font-size: 1.5rem;
            text-align: center;
            letter-spacing: 0.5em;
            text-transform: uppercase;
            max-width: 320px;
            margin: 0 auto var(--space-6);
        }
        
        .verification-timer {
            font-family: var(--font-mono);
            font-size: 1.125rem;
            color: var(--crimson-red);
            font-weight: 600;
        }
        
        
        /* Executive Terms Agreement */
        .terms-agreement {
            display: flex;
            align-items: flex-start;
            gap: var(--space-4);
            margin: var(--space-8) 0;
        }
        
        .terms-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid rgba(212, 175, 55, 0.6);
            border-radius: var(--radius-tight);
            background: transparent;
            cursor: pointer;
            margin-top: 2px;
        }
        
        .terms-checkbox:checked {
            background: var(--platinum-gold);
            border-color: var(--platinum-gold);
        }
        
        .terms-text {
            font-size: 0.875rem;
            color: var(--pearl-grey);
            line-height: 1.6;
            cursor: pointer;
        }
        
        /* Loading Executive States */
        .command-loading {
            pointer-events: none;
            opacity: 0.8;
        }
        
        .loading-spinner {
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid var(--pure-white);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Responsive Executive Layout */
        @media (max-width: 768px) {
            .institutional-container {
                padding: 0 var(--space-4);
            }
            
            .toolkit-navigation {
                margin-top: 52px; /* Account for larger ticker on mobile */
            }
            
            .toolkit-header {
                padding: var(--space-4) var(--space-4);
                flex-direction: column;
                gap: var(--space-3);
                text-align: center;
            }
            
            .toolkit-title {
                font-size: 1.4rem;
            }
            
            .toolkit-nav {
                padding: var(--space-3) var(--space-4);
                flex-direction: column;
                gap: var(--space-3);
                align-items: stretch;
            }
            
            .nav-link {
                justify-content: center;
                padding: var(--space-3) var(--space-4);
            }
            
            .user-section {
                flex-direction: column;
                gap: var(--space-2);
                text-align: center;
            }
            
            .password-expiry {
                justify-content: center;
            }
            
            /* Updated Mobile Logo Styles */
            .logo-with-globe {
                flex-direction: column;
                align-items: center;
                gap: var(--space-1);
            }
            
            .atlas-text, .nexus-text {
                font-size: 2.8rem;
                text-align: center;
            }
            
            .globe-center {
                width: 70px;
                height: 70px;
                margin: var(--space-1) 0;
            }
            
            .globe-center svg {
                width: 66px;
                height: 66px;
            }
            
            /* Mobile Authorization Alert Styles */
            .alert-warning {
                padding: var(--space-6);
                margin: var(--space-4) 0;
            }
            
            .alert-warning h4 {
                font-size: 1.4rem;
                margin-bottom: var(--space-3);
                text-shadow: 
                    -1px -1px 0 #000000,
                    1px -1px 0 #000000,
                    -1px 1px 0 #000000,
                    1px 1px 0 #000000,
                    2px 2px 6px rgba(0, 0, 0, 0.9),
                    0 0 15px rgba(0, 0, 0, 0.7);
            }
            
            .alert-warning p {
                font-size: 1rem;
                text-shadow: 
                    -1px -1px 0 #000000,
                    1px -1px 0 #000000,
                    -1px 1px 0 #000000,
                    1px 1px 0 #000000,
                    2px 2px 4px rgba(0, 0, 0, 0.8),
                    0 0 10px rgba(0, 0, 0, 0.6);
            }
            
            .alert-warning p strong {
                text-shadow: 
                    -1px -1px 0 #000000,
                    1px -1px 0 #000000,
                    -1px 1px 0 #000000,
                    1px 1px 0 #000000,
                    2px 2px 6px rgba(0, 0, 0, 0.9),
                    0 0 12px rgba(0, 0, 0, 0.7);
            }
            
            .portal-content {
                padding: var(--space-8) var(--space-6);
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .address-grid {
                grid-template-columns: 1fr;
            }
            
            .form-section {
                padding: var(--space-6);
                margin-bottom: var(--space-6);
            }
            
            .address-section {
                padding: var(--space-4);
                margin-top: var(--space-4);
            }
            
            .input-group {
                flex-direction: column;
                gap: var(--space-2);
            }
            
            .input-group .field-select {
                width: 100%;
            }
            
            .access-navigation {
                flex-direction: column;
            }
            
            .market-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .ticker-item {
                margin-right: var(--space-4);
            }
        }
        
        /* Professional Footer */
        .executive-footer {
            background: linear-gradient(135deg, rgba(20, 25, 31, 0.98) 0%, rgba(31, 41, 55, 0.95) 100%);
            backdrop-filter: blur(24px);
            border-top: 1px solid rgba(212, 175, 55, 0.2);
            padding: var(--space-8) 0 var(--space-6);
            margin-top: var(--space-16);
            position: relative;
        }
        
        .executive-footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent 0%, var(--platinum-gold) 50%, transparent 100%);
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space-6);
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: var(--space-8);
            align-items: start;
        }
        
        .footer-brand {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }
        
        .footer-logo {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            margin-bottom: var(--space-2);
        }
        
        .footer-logo-globe {
            width: 32px;
            height: 32px;
        }
        
        .footer-logo-text {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--pure-white);
            letter-spacing: -0.02em;
        }
        
        .footer-description {
            color: rgba(184, 192, 200, 0.9);
            font-size: 0.95rem;
            line-height: 1.6;
            max-width: 300px;
        }
        
        .footer-section {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }
        
        .footer-title {
            color: var(--platinum-gold);
            font-family: var(--font-display);
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: var(--space-2);
        }
        
        .footer-link {
            color: rgba(184, 192, 200, 0.8);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            padding: var(--space-1) 0;
        }
        
        .footer-link:hover {
            color: var(--platinum-gold);
            padding-left: var(--space-2);
        }
        
        .footer-bottom {
            border-top: 1px solid rgba(184, 192, 200, 0.1);
            margin-top: var(--space-6);
            padding-top: var(--space-4);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--space-4);
        }
        
        .footer-copyright {
            color: rgba(184, 192, 200, 0.7);
            font-size: 0.85rem;
        }
        
        .footer-badges {
            display: flex;
            gap: var(--space-4);
            align-items: center;
        }
        
        .security-badge {
            display: flex;
            align-items: center;
            gap: var(--space-1);
            color: rgba(184, 192, 200, 0.8);
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .security-badge svg {
            width: 16px;
            height: 16px;
            fill: var(--platinum-gold);
        }
        
        /* Mobile Footer */
        @media (max-width: 768px) {
            .footer-content {
                grid-template-columns: 1fr;
                gap: var(--space-6);
                text-align: center;
            }
            
            .footer-brand {
                align-items: center;
            }
            
            .footer-description {
                max-width: none;
            }
            
            .footer-bottom {
                flex-direction: column;
                text-align: center;
            }
            
            .footer-badges {
                justify-content: center;
            }
        }
        
        /* Enhanced Mobile Responsiveness */
        @media (max-width: 768px) {
            .ticker-container {
                padding: 8px 10px;
            }
            
            .ticker-item {
                margin: 0 15px;
                font-size: 0.85rem;
            }
            
            .main-container {
                padding: 15px;
            }
            
            .auth-card {
                padding: 25px 20px;
                margin: 20px auto;
            }
            
            .header-title {
                font-size: 1.8rem;
            }
            
            .header-subtitle {
                font-size: 0.9rem;
            }
            
            .form-section h3 {
                font-size: 1rem;
            }
            
            .input-group input {
                font-size: 16px !important; /* Prevents zoom on iOS */
                padding: 12px;
            }
            
            .submit-button {
                padding: 14px 20px;
                font-size: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .ticker-container {
                padding: 6px 8px;
            }
            
            .ticker-item {
                font-size: 0.75rem;
                margin: 0 10px;
            }
            
            .header-title {
                font-size: 1.5rem;
                line-height: 1.2;
            }
            
            .header-subtitle {
                font-size: 0.85rem;
            }
            
            .auth-card {
                padding: 20px 15px;
                border-radius: 12px;
            }
            
            .form-section {
                padding: 15px;
            }
            
            .registration-toggle {
                font-size: 0.85rem;
                padding: 8px 16px;
            }
            
            /* Fix input fields on all mobile devices */
            input[type="text"],
            input[type="password"],
            input[type="email"],
            input[type="tel"],
            select {
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
                font-size: 16px !important;
                width: 100%;
                box-sizing: border-box;
            }
            
            /* Adjust footer for mobile */
            .footer-section {
                padding: 15px;
                font-size: 0.75rem;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        /* Prevent horizontal scroll on all devices */
        html, body {
            overflow-x: hidden;
            width: 100%;
            margin: 0;
            padding: 0;
        }
        
        /* Ensure proper scaling */
        html {
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }
    </style>
</head>
<body>
    <script>
        // Executive Security Enforcement - Removed to prevent redirect loop
        // Authentication is properly handled server-side in app.py
    </script>

    <!-- Bloomberg-Style Financial Ticker -->
    <div class="financial-ticker">
        <div class="ticker-container" id="financialTicker">
            <!-- Content will be populated by JavaScript -->
        </div>
    </div>

    <div class="institutional-container">
        <!-- Executive Header Command -->
        <header class="toolkit-navigation" id="toolkitNav">
            <div class="corporate-identity">
                <div class="logo-with-globe">
                    <h1 class="atlas-text">ATLAS</h1>
                    <div class="globe-center">
                    <svg viewBox="0 0 48 48" fill="none">
                        <!-- Professional World Globe -->
                        <defs>
                            <!-- Ocean Gradient -->
                            <radialGradient id="oceanGradient" cx="50%" cy="30%" r="60%">
                                <stop offset="0%" style="stop-color:#4FC3F7;stop-opacity:1"/>
                                <stop offset="50%" style="stop-color:#29B6F6;stop-opacity:1"/>
                                <stop offset="100%" style="stop-color:#0277BD;stop-opacity:1"/>
                            </radialGradient>
                            
                            <!-- Land Gradient -->
                            <linearGradient id="landGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#66BB6A;stop-opacity:1"/>
                                <stop offset="50%" style="stop-color:#4CAF50;stop-opacity:1"/>
                                <stop offset="100%" style="stop-color:#388E3C;stop-opacity:1"/>
                            </linearGradient>
                            
                            <!-- Highlight Gradient -->
                            <radialGradient id="highlightGradient" cx="30%" cy="25%" r="40%">
                                <stop offset="0%" style="stop-color:#FFFFFF;stop-opacity:0.4"/>
                                <stop offset="70%" style="stop-color:#FFFFFF;stop-opacity:0.1"/>
                                <stop offset="100%" style="stop-color:#FFFFFF;stop-opacity:0"/>
                            </radialGradient>
                            
                            <!-- Gold Border Gradient -->
                            <linearGradient id="borderGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#FFD700;stop-opacity:1"/>
                                <stop offset="50%" style="stop-color:#FFC107;stop-opacity:1"/>
                                <stop offset="100%" style="stop-color:#FF8F00;stop-opacity:1"/>
                            </linearGradient>
                        </defs>
                        
                        <!-- Globe Base (Ocean) -->
                        <circle cx="24" cy="24" r="18" 
                                fill="url(#oceanGradient)" 
                                stroke="url(#borderGradient)" 
                                stroke-width="2"/>
                        
                        <!-- Continents -->
                        <!-- North America -->
                        <path d="M14 18 Q17 15 21 17 Q23 19 20 23 Q16 25 14 21 Z" 
                              fill="url(#landGradient)"/>
                        
                        <!-- Europe/Africa -->
                        <path d="M26 14 Q30 12 33 16 Q35 20 31 24 Q27 22 26 18 Z" 
                              fill="url(#landGradient)"/>
                        
                        <!-- Asia -->
                        <path d="M32 18 Q36 16 38 20 Q37 24 33 22 Q32 20 32 18 Z" 
                              fill="url(#landGradient)"/>
                        
                        <!-- Australia -->
                        <ellipse cx="34" cy="30" rx="2.5" ry="2" fill="url(#landGradient)"/>
                        
                        <!-- South America -->
                        <path d="M18 28 Q21 27 22 31 Q23 35 19 36 Q16 34 17 30 Z" 
                              fill="url(#landGradient)"/>
                        
                        <!-- Latitude Lines -->
                        <ellipse cx="24" cy="24" rx="18" ry="5" 
                                 fill="none" 
                                 stroke="rgba(255,255,255,0.3)" 
                                 stroke-width="0.8"/>
                        <ellipse cx="24" cy="24" rx="18" ry="10" 
                                 fill="none" 
                                 stroke="rgba(255,255,255,0.3)" 
                                 stroke-width="0.8"/>
                        
                        <!-- Longitude Lines -->
                        <ellipse cx="24" cy="24" rx="5" ry="18" 
                                 fill="none" 
                                 stroke="rgba(255,255,255,0.3)" 
                                 stroke-width="0.8"/>
                        <ellipse cx="24" cy="24" rx="10" ry="18" 
                                 fill="none" 
                                 stroke="rgba(255,255,255,0.3)" 
                                 stroke-width="0.8"/>
                        
                        <!-- Equator -->
                        <line x1="6" y1="24" x2="42" y2="24" 
                              stroke="rgba(255,255,255,0.4)" 
                              stroke-width="1"/>
                        
                        <!-- Prime Meridian -->
                        <ellipse cx="24" cy="24" rx="0.5" ry="18" 
                                 fill="none" 
                                 stroke="rgba(255,255,255,0.4)" 
                                 stroke-width="1"/>
                        
                        <!-- Globe Highlight -->
                        <ellipse cx="24" cy="24" rx="18" ry="18" 
                                 fill="url(#highlightGradient)"/>
                        
                        <!-- Atlas Connection Points (Golden) -->
                        <circle cx="16" cy="16" r="1.2" fill="#FFD700" opacity="0.9"/>
                        <circle cx="32" cy="16" r="1.2" fill="#FFD700" opacity="0.9"/>
                        <circle cx="16" cy="32" r="1.2" fill="#FFD700" opacity="0.9"/>
                        <circle cx="32" cy="32" r="1.2" fill="#FFD700" opacity="0.9"/>
                        
                        <!-- Nexus Lines (Connecting the world) -->
                        <path d="M16 16 Q24 10 32 16 Q38 24 32 32 Q24 38 16 32 Q10 24 16 16" 
                              fill="none" 
                              stroke="#FFD700" 
                              stroke-width="1" 
                              opacity="0.6"/>
                    </svg>
                    </div>
                    <h1 class="nexus-text">NEXUS</h1>
                </div>
            </div>
            
            <!-- Toolkit Navigation Controls -->
            <div class="toolkit-header">
                <div class="nav-controls">
                    <button class="hide-nav-btn" onclick="toggleNavigation()">
                        <svg viewBox="0 0 24 24" style="width: 14px; height: 14px; fill: currentColor; margin-right: 4px;">
                            <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/>
                        </svg>
                        Hide Toolkit
                    </button>
                </div>
            </div>
            
            <!-- Toolkit Navigation Links -->
            <nav class="toolkit-nav">
                <!-- Login/User Section -->
                <div id="loginSection">
                    <a href="#" class="nav-link" onclick="navigateToLogin()">
                        <svg viewBox="0 0 24 24">
                            <path d="M10,17V14H3V10H10V7L15,12L10,17M10,2H19A2,2 0 0,1 21,4V20A2,2 0 0,1 19,22H10A2,2 0 0,1 8,20V18H10V20H19V4H10V6H8V4A2,2 0 0,1 10,2Z"/>
                        </svg>
                        Login
                    </a>
                </div>
                
                <!-- Market Updates -->
                <a href="/market-updates" class="nav-link">
                    <svg viewBox="0 0 24 24">
                        <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                    </svg>
                    Market Updates
                </a>
                
                <!-- Data -->
                <a href="#" class="nav-link" onclick="openDataTools()">
                    <svg viewBox="0 0 24 24">
                        <path d="M12,3C7.58,3 4,4.79 4,7V17C4,19.21 7.58,21 12,21C16.42,21 20,19.21 20,17V7C20,4.79 16.42,3 12,3M18,17C18,17.5 15.87,19 12,19C8.13,19 6,17.5 6,17V14.77C7.61,15.55 9.72,16 12,16C14.28,16 16.39,15.55 18,14.77V17M18,12.45C16.7,13.4 14.42,14 12,14C9.58,14 7.3,13.4 6,12.45V9.64C7.47,10.47 9.61,11 12,11C14.39,11 16.53,10.47 18,9.64V12.45M12,9C8.13,9 6,7.5 6,7C6,6.5 8.13,5 12,5C15.87,5 18,6.5 18,7C18,7.5 15.87,9 12,9Z"/>
                    </svg>
                    Data
                </a>
                
                <!-- Analytics -->
                <a href="#" class="nav-link" onclick="openAnalytics()">
                    <svg viewBox="0 0 24 24">
                        <path d="M22,21H2V3H4V19H6V17H10V19H12V16H16V19H18V17H22V21M16,8L18.5,13H13.5L16,8M10,13H6.5L9,8L10,13Z"/>
                    </svg>
                    Analytics
                </a>
                
                <!-- Risk Management -->
                <a href="#" class="nav-link" onclick="openRiskManagement()">
                    <svg viewBox="0 0 24 24">
                        <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,11.5 16,12.4 16,13V16C16,17.4 15.4,18 14.8,18H9.2C8.6,18 8,17.4 8,16V13C8,12.4 8.6,11.5 9.2,11.5V10C9.2,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.5,8.7 10.5,10V11.5H13.5V10C13.5,8.7 12.8,8.2 12,8.2Z"/>
                    </svg>
                    Risk Management
                </a>
                
                <!-- Portfolio -->
                <a href="#" class="nav-link" onclick="openPortfolio()">
                    <svg viewBox="0 0 24 24">
                        <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10Z"/>
                    </svg>
                    Portfolio
                </a>
                
                <!-- Compliance -->
                <a href="#" class="nav-link" onclick="openCompliance()">
                    <svg viewBox="0 0 24 24">
                        <path d="M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1Z"/>
                    </svg>
                    Compliance
                </a>
                
                <!-- Settings -->
                <a href="#" class="nav-link" onclick="openSettings()">
                    <svg viewBox="0 0 24 24">
                        <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                    </svg>
                    Settings
                </a>
            </nav>
        </header>

        <!-- Show Navigation Button (hidden by default) -->
        <button class="show-nav-btn" id="showNavBtn" onclick="toggleNavigation()">
            ▼ Show Toolkit
        </button>
        
        <!-- Floating Help Button -->
        <button class="help-button" onclick="toggleHelpTooltip()" id="helpButton">
            <svg viewBox="0 0 24 24">
                <path d="M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z"/>
            </svg>
        </button>
        
        <!-- Help Tooltip -->
        <div class="help-tooltip" id="helpTooltip">
            <div class="help-content">
                <h4>
                    <svg viewBox="0 0 24 24">
                        <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                    </svg>
                    Need Help?
                </h4>
                <p>Our institutional support team is available 24/7 to assist with platform access, technical issues, and account management.</p>
                <div class="support-info">
                    <a href="mailto:support@atlasnexus.com" class="support-email">
                        <svg viewBox="0 0 24 24">
                            <path d="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"/>
                        </svg>
                        support@atlasnexus.com
                    </a>
                </div>
            </div>
        </div>

        <!-- Market Intelligence Preview -->
        <section class="market-preview" id="marketPreview">
            <div class="market-preview-header">
                <div class="market-preview-title">
                    <svg viewBox="0 0 24 24">
                        <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                    </svg>
                    <h3>Market Intelligence Preview</h3>
                </div>
                <div class="market-status">
                    <div class="status-indicator" id="marketStatusIndicator"></div>
                    <span id="marketStatusText">Markets Open</span>
                </div>
            </div>
            
            <div class="market-preview-grid">
                <div class="market-widget">
                    <div class="widget-header">
                        <h4 class="widget-title">S&P 500</h4>
                        <span class="widget-change positive" id="spxChange">+0.8%</span>
                    </div>
                    <p class="widget-value" id="spxValue">4,567.89</p>
                </div>
                
                <div class="market-widget">
                    <div class="widget-header">
                        <h4 class="widget-title">10Y Treasury</h4>
                        <span class="widget-change negative" id="treasuryChange">-3bps</span>
                    </div>
                    <p class="widget-value" id="treasuryValue">4.67%</p>
                </div>
                
                <div class="market-widget">
                    <div class="widget-header">
                        <h4 class="widget-title">VIX</h4>
                        <span class="widget-change positive" id="vixChange">+2.1</span>
                    </div>
                    <p class="widget-value" id="vixValue">18.45</p>
                </div>
            </div>
            
            <div class="daily-insights">
                <h4 class="insights-title">
                    <svg viewBox="0 0 24 24">
                        <path d="M9,22A1,1 0 0,1 8,21V18H4A2,2 0 0,1 2,16V4C2,2.89 2.9,2 4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H13.9L10.2,21.71C10,21.9 9.75,22 9.5,22H9M20,16V4H4V16H8.5L12,19.5L15.5,16H20Z"/>
                    </svg>
                    Today's Market Insight
                </h4>
                <p class="insights-content" id="dailyInsight">
                    Central banks maintain hawkish stance as inflation remains elevated. Credit spreads tightening across IG and HY markets, with particular strength in financial sectors. European sovereigns outperforming amid ECB policy expectations.
                </p>
            </div>
            
            <div class="login-prompt">
                <p class="login-prompt-text">
                    Access comprehensive market analysis, real-time credit data, and institutional-grade research
                </p>
                <button class="access-full-markets" onclick="window.location.href='/market-updates'">
                    View Market Intelligence Preview
                </button>
            </div>
        </section>

        <!-- Access Command Portal -->
        <main class="access-portal">
            <!-- Executive Navigation -->
            <nav class="access-navigation">
                <button class="nav-control active" data-target="access">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM15.1 8H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2z"/>
                    </svg>
                    Login Access
                </button>
                <button class="nav-control" data-target="registration">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                    Authorisation Request
                </button>
            </nav>

            <div class="portal-content">
                <!-- Flash Messages -->
                
                    
                

                <!-- Institutional Access Section -->
                <div class="content-section active" id="access-section">
                    <div class="section-command">
                        <h2 class="command-title">Login Access</h2>
                        <p class="command-subtitle">Secure access for authorised personnel</p>
                    </div>

                    <form method="POST" action="/auth" id="accessForm" class="form-executive">
                        <input type="hidden" name="action" value="login">
                        
                        <div class="form-grid">
                            <div class="form-field">
                                <label class="field-label">Verified Email</label>
                                <input type="email" 
                                       class="field-input" 
                                       name="email" 
                                       id="emailField"
                                       placeholder="firstname.lastname@institution.co.uk"
                                       autocomplete="email"
                                       required>
                                <div class="field-hint">Use your authorised email address</div>
                            </div>
                            
                            <div class="form-field">
                                <label class="field-label">Password Credentials</label>
                                <input type="password" 
                                       class="field-input" 
                                       name="password" 
                                       id="passwordField"
                                       placeholder="Your generated password"
                                       autocomplete="current-password"
                                       required>
                                <div class="field-hint">This renews every 30 days</div>
                            </div>
                        </div>
                        
                        <!-- Remember Credentials Option -->
                        <div class="form-field">
                            <div class="terms-agreement">
                                <input type="checkbox" 
                                       class="terms-checkbox" 
                                       id="rememberCredentials" 
                                       checked>
                                <label class="terms-text" for="rememberCredentials">
                                    Remember my credentials on this secure device for faster access
                                </label>
                            </div>
                        </div>

                        <button type="submit" class="action-command command-primary command-full">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                            </svg>
                            Request Network Access
                        </button>
                    </form>

                    <!-- Verification Command Centre -->
                    <div class="verification-centre" id="verificationCentre" style="display: none;">
                        <h3 class="command-title">SMS Authentication Code Request</h3>
                        <p class="command-subtitle">Enter verification code sent to your registered device</p>
                        
                        <form method="POST" action="/verify-access-code" id="verificationForm" class="form-executive">
                            <div class="form-field">
                                <label class="field-label">6-Digit Verification Code</label>
                                <input type="text" 
                                       class="field-input verification-code-field" 
                                       name="verification_code" 
                                       placeholder="ABC123"
                                       maxlength="6"
                                       required>
                                <div class="field-hint">
                                    Code expires in <span class="verification-timer" id="codeTimer">15:00</span>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <button type="submit" class="action-command command-success command-full">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/>
                                    </svg>
                                    Verify & Access Platform
                                </button>
                            </div>
                        </form>
                        
                        <div class="form-grid">
                            <button type="button" class="action-command command-secondary" onclick="requestNewCode()">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                                </svg>
                                Request New Code
                            </button>
                            <button type="button" class="action-command command-secondary" onclick="goBackToLogin()">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                                </svg>
                                Go Back to Login
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Authorisation Request Section -->
                <div class="content-section" id="registration-section">
                    <div class="section-command">
                        <h2 class="command-title">Authorisation Request</h2>
                        <p class="command-subtitle">Apply for institutional platform access</p>
                    </div>

                    <!-- Registration Status Alert -->
                    <div class="executive-alert alert-warning" id="registrationStatus" style="display: none;">
                        <h4>Authorisation Pending Review</h4>
                        <p>Your access request has been submitted for institutional verification.</p>
                        <p><strong>Required:</strong> Provide government-issued identification matching personal address.</p>
                        <p>Await approval confirmation. Additional requests are not permitted during review.</p>
                    </div>

                    <form method="POST" action="/register-user" id="registrationForm" class="form-executive">
                        
                        <!-- Personal Information Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h3 class="section-title">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                                    </svg>
                                    Personal Information
                                </h3>
                                <p class="section-subtitle">Identity verification details</p>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-field">
                                    <label class="field-label">Full Name</label>
                                    <input type="text" 
                                           class="field-input" 
                                           name="full_name" 
                                           placeholder="John Alexander Smith"
                                           required>
                                    <div class="field-hint">As shown on a form of valid ID</div>
                                </div>
                                
                                <div class="form-field">
                                    <label class="field-label">Date of Birth</label>
                                    <input type="date" 
                                           class="field-input" 
                                           name="date_of_birth" 
                                           required>
                                    <div class="field-hint">Must match valid ID</div>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-field">
                                    <label class="field-label">Email Address</label>
                                    <input type="email" 
                                           class="field-input" 
                                           name="email" 
                                           placeholder="john.smith@gmail.com"
                                           required>
                                    <div class="field-hint">Primary email for verification</div>
                                </div>
                                
                                <div class="form-field">
                                    <label class="field-label">Mobile Number</label>
                                    <div class="input-group">
                                        <select class="field-select" name="country_code" style="width: 100px; margin-right: 8px;">
                                            <option value="+44" selected>+44</option>
                                            <option value="+1">+1</option>
                                            <option value="+33">+33</option>
                                            <option value="+49">+49</option>
                                            <option value="+31">+31</option>
                                            <option value="+41">+41</option>
                                            <option value="+353">+353</option>
                                        </select>
                                        <input type="tel" 
                                               class="field-input" 
                                               name="phone" 
                                               placeholder="7700 900000"
                                               style="flex: 1;"
                                               required>
                                    </div>
                                    <div class="field-hint">Required for SMS authentication</div>
                                </div>
                            </div>
                            
                            <!-- Residential Address -->
                            <div class="address-section">
                                <h4 class="address-title">Residential Address</h4>
                                <div class="form-grid">
                                    <div class="form-field address-field-full address-field-autocomplete">
                                        <label class="field-label">Street Address</label>
                                        <input type="text" 
                                               class="field-input" 
                                               name="personal_street" 
                                               id="personal_street_autocomplete"
                                               placeholder="Start typing address... e.g. 5 Intalbury Avenue"
                                               required>
                                        <i class="fas fa-map-marker-alt address-autocomplete-icon" title="Address autocomplete enabled"></i>
                                    </div>
                                </div>
                                <div class="form-grid address-grid">
                                    <div class="form-field">
                                        <label class="field-label">City</label>
                                        <input type="text" 
                                               class="field-input" 
                                               name="personal_city" 
                                               id="personal_city"
                                               placeholder="London"
                                               required>
                                    </div>
                                    <div class="form-field">
                                        <label class="field-label">Postcode</label>
                                        <input type="text" 
                                               class="field-input" 
                                               name="personal_postcode" 
                                               id="personal_postcode"
                                               placeholder="SW1A 1AA"
                                               required>
                                    </div>
                                    <div class="form-field">
                                        <label class="field-label">Country</label>
                                        <select class="field-select" name="personal_country" id="personal_country" required>
                                            <option value="">Select country</option>
                                            <option value="United Kingdom" selected>United Kingdom</option>
                                            <option value="Ireland">Ireland</option>
                                            <option value="France">France</option>
                                            <option value="Germany">Germany</option>
                                            <option value="Netherlands">Netherlands</option>
                                            <option value="Switzerland">Switzerland</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Professional Information Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h3 class="section-title">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M20 6h-2.18c.11-.31.18-.65.18-1a2.996 2.996 0 0 0-5.5-1.65l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"/>
                                    </svg>
                                    Professional Information
                                </h3>
                                <p class="section-subtitle">Employment and institutional details</p>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-field">
                                    <label class="field-label">Organisation/Institution</label>
                                    <input type="text" 
                                           class="field-input" 
                                           name="company" 
                                           placeholder="Barclays Investment Bank"
                                           required>
                                    <div class="field-hint">Current employer organisation</div>
                                </div>
                                
                                <div class="form-field">
                                    <label class="field-label">Professional Title</label>
                                    <select class="field-select" name="role" required>
                                        <option value="">Select professional title</option>
                                        <option value="Managing Director">Managing Director</option>
                                        <option value="Executive Director">Executive Director</option>
                                        <option value="Non Executive Director">Non Executive Director</option>
                                        <option value="Senior Vice President">Senior Vice President</option>
                                        <option value="Vice President">Vice President</option>
                                        <option value="Assistant Vice President">Assistant Vice President</option>
                                        <option value="Portfolio Manager">Portfolio Manager</option>
                                        <option value="Senior Analyst">Senior Analyst</option>
                                        <option value="Quantitative Analyst">Quantitative Analyst</option>
                                        <option value="Risk Manager">Risk Manager</option>
                                        <option value="Credit Analyst">Credit Analyst</option>
                                        <option value="Structuring Analyst">Structuring Analyst</option>
                                        <option value="Research Analyst">Research Analyst</option>
                                        <option value="Director">Director</option>
                                        <option value="Associate Director">Associate Director</option>
                                        <option value="Senior Associate">Senior Associate</option>
                                        <option value="Other">Other (Specify Below)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-field">
                                <label class="field-label">Company Number</label>
                                <input type="text" 
                                       class="field-input" 
                                       name="company_number" 
                                       placeholder="12345678"
                                       required>
                                <div class="field-hint">Companies House registration number</div>
                                
                                <!-- Companies House Search Helper -->
                                <div class="companies-house-search" style="
                                    background: rgba(26, 29, 35, 0.8);
                                    border: 1px solid rgba(212, 175, 55, 0.25);
                                    border-radius: var(--radius-large);
                                    padding: var(--space-6);
                                    margin-top: var(--space-6);
                                    backdrop-filter: blur(8px);
                                ">
                                    <div style="
                                        display: flex;
                                        align-items: center;
                                        margin-bottom: var(--space-4);
                                        gap: var(--space-3);
                                    ">
                                        <i class="fas fa-search" style="
                                            color: var(--platinum-gold);
                                            font-size: 20px;
                                        "></i>
                                        <span style="
                                            font-family: var(--font-text);
                                            font-size: 1.25rem;
                                            font-weight: 600;
                                            color: var(--pure-white);
                                        ">Need help finding your company details?</span>
                                    </div>
                                    <div style="
                                        display: flex;
                                        gap: var(--space-3);
                                        margin-bottom: var(--space-4);
                                        align-items: stretch;
                                    ">
                                        <input type="text" 
                                               class="field-input" 
                                               id="companySearchInput" 
                                               placeholder="Enter your company name to search..."
                                               style="
                                                   flex: 1;
                                                   font-size: 1.1rem;
                                                   padding: var(--space-4);
                                               ">
                                        <button type="button" 
                                                onclick="searchCompaniesHouse()"
                                                style="
                                                    background: linear-gradient(135deg, var(--platinum-gold) 0%, #E5C547 100%);
                                                    color: var(--deep-charcoal);
                                                    border: none;
                                                    border-radius: var(--radius-medium);
                                                    padding: var(--space-4) var(--space-6);
                                                    font-family: var(--font-text);
                                                    font-size: 1.1rem;
                                                    font-weight: 600;
                                                    cursor: pointer;
                                                    transition: all 0.2s ease;
                                                    display: flex;
                                                    align-items: center;
                                                    gap: var(--space-2);
                                                    white-space: nowrap;
                                                "
                                                onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px rgba(212, 175, 55, 0.3)'"
                                                onmouseout="this.style.transform=''; this.style.boxShadow=''">
                                            <i class="fas fa-external-link-alt"></i>
                                            <span>Search Companies House</span>
                                        </button>
                                    </div>
                                    <div style="
                                        color: var(--silver-mist);
                                        font-size: 1.05rem;
                                        line-height: 1.6;
                                        display: flex;
                                        align-items: flex-start;
                                        gap: var(--space-3);
                                        padding: var(--space-3);
                                        background: rgba(212, 175, 55, 0.1);
                                        border-radius: var(--radius-medium);
                                    ">
                                        <i class="fas fa-info-circle" style="
                                            color: var(--platinum-gold);
                                            margin-top: 3px;
                                            font-size: 16px;
                                        "></i>
                                        <span>This will open Companies House in a new tab to help you find your company number and registered address</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Registered Company Address -->
                            <div class="address-section">
                                <h4 class="address-title">Registered Company Address</h4>
                                <div class="form-grid">
                                    <div class="form-field address-field-full address-field-autocomplete">
                                        <label class="field-label">Registered Street Address</label>
                                        <input type="text" 
                                               class="field-input" 
                                               name="business_street" 
                                               id="business_street_autocomplete"
                                               placeholder="Start typing registered address... e.g. 1 Churchill Place"
                                               required>
                                        <i class="fas fa-building address-autocomplete-icon" title="Address autocomplete enabled"></i>
                                    </div>
                                </div>
                                <div class="form-grid address-grid">
                                    <div class="form-field">
                                        <label class="field-label">City</label>
                                        <input type="text" 
                                               class="field-input" 
                                               name="business_city" 
                                               id="business_city"
                                               placeholder="London"
                                               required>
                                    </div>
                                    <div class="form-field">
                                        <label class="field-label">Postcode</label>
                                        <input type="text" 
                                               class="field-input" 
                                               name="business_postcode" 
                                               id="business_postcode"
                                               placeholder="E14 5HP"
                                               required>
                                    </div>
                                    <div class="form-field">
                                        <label class="field-label">Country</label>
                                        <select class="field-select" name="business_country" id="business_country" required>
                                            <option value="">Select country</option>
                                            <option value="United Kingdom" selected>United Kingdom</option>
                                            <option value="Ireland">Ireland</option>
                                            <option value="France">France</option>
                                            <option value="Germany">Germany</option>
                                            <option value="Netherlands">Netherlands</option>
                                            <option value="Switzerland">Switzerland</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Terms and Conditions -->
                        <div class="form-section">
                            <div class="terms-agreement">
                                <input type="checkbox" 
                                       class="terms-checkbox" 
                                       id="termsCheck" 
                                       required>
                                <label class="terms-text" for="termsCheck">
                                    I certify that all information provided is accurate and complete. I agree to provide valid identification and supporting documentation when required for institutional verification. I understand that providing false information may result in permanent access denial and potential legal action under UK law.
                                </label>
                            </div>
                            
                            <button type="submit" class="action-command command-primary command-full" id="submitBtn">
                                <span id="submitBtnContent">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                                    </svg>
                                    Submit Authorisation Request
                                </span>
                                <span id="submitBtnLoading" style="display: none;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="spinning">
                                        <path d="M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"/>
                                    </svg>
                                    Processing Request...
                                </span>
                            </button>
                            
                            <!-- Success Message -->
                            <div id="successMessage" style="display: none; background: linear-gradient(135deg, #28a745, #20c997); color: white; padding: 15px; border-radius: 8px; margin-top: 15px; text-align: center;">
                                <i class="fas fa-check-circle me-2"></i>
                                <strong>Registration Submitted Successfully!</strong><br>
                                <small>You will receive confirmation within 24-48 hours at the email address provided.</small>
                            </div>
                            
                            <div class="field-hint" style="text-align: center; margin-top: var(--space-5);">
                                Institutional verification completed within 24-48 business hours
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </main>

    </div>

    <!-- Professional Footer -->
    <footer class="executive-footer">
        <div class="footer-content">
            <!-- Brand Section -->
            <div class="footer-brand">
                <div class="footer-logo">
                    <div class="footer-logo-globe">
                        <svg viewBox="0 0 48 48" fill="none">
                            <!-- Simplified Globe for Footer -->
                            <defs>
                                <radialGradient id="footerOceanGradient" cx="50%" cy="30%" r="60%">
                                    <stop offset="0%" style="stop-color:#4FC3F7;stop-opacity:1"/>
                                    <stop offset="100%" style="stop-color:#0277BD;stop-opacity:1"/>
                                </radialGradient>
                                <linearGradient id="footerLandGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#66BB6A;stop-opacity:1"/>
                                    <stop offset="100%" style="stop-color:#388E3C;stop-opacity:1"/>
                                </linearGradient>
                            </defs>
                            <circle cx="24" cy="24" r="16" fill="url(#footerOceanGradient)" stroke="#FFD700" stroke-width="1"/>
                            <path d="M14 18 Q17 15 21 17 Q23 19 20 23 Q16 25 14 21 Z" fill="url(#footerLandGradient)"/>
                            <path d="M25 14 Q28 12 31 16 Q33 20 30 24 Q27 26 25 22 Z" fill="url(#footerLandGradient)"/>
                            <circle cx="34" cy="30" r="2" fill="url(#footerLandGradient)"/>
                        </svg>
                    </div>
                    <span class="footer-logo-text">ATLASNEXUS</span>
                </div>
                <p class="footer-description">
                    Leading institutional platform for global financial intelligence, securitisation analysis, and risk management solutions.
                </p>
            </div>

            <!-- Platform Section -->
            <div class="footer-section">
                <h4 class="footer-title">Platform</h4>
                <a href="#" class="footer-link">Dashboard</a>
                <a href="#" class="footer-link">Analytics</a>
                <a href="#" class="footer-link">Risk Management</a>
                <a href="#" class="footer-link">Market Intelligence</a>
                <a href="#" class="footer-link">Compliance</a>
            </div>

            <!-- Support Section -->
            <div class="footer-section">
                <h4 class="footer-title">Support</h4>
                <a href="#" class="footer-link">Documentation</a>
                <a href="#" class="footer-link">API Reference</a>
                <a href="#" class="footer-link">Training</a>
                <a href="#" class="footer-link">Contact</a>
                <a href="#" class="footer-link">Status</a>
            </div>

            <!-- Legal Section -->
            <div class="footer-section">
                <h4 class="footer-title">Legal</h4>
                <a href="#" class="footer-link">Privacy Policy</a>
                <a href="#" class="footer-link">Terms of Service</a>
                <a href="#" class="footer-link">Compliance</a>
                <a href="#" class="footer-link">Data Protection</a>
                <a href="#" class="footer-link">Security</a>
            </div>
        </div>

        <!-- Footer Bottom -->
        <div class="footer-content">
            <div class="footer-bottom">
                <div class="footer-copyright">
                    © 2024 AtlasNexus. All rights reserved. Regulated by the Financial Conduct Authority.
                </div>
                <div class="footer-badges">
                    <div class="security-badge">
                        <svg viewBox="0 0 24 24">
                            <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,11.5 16,12.4 16,13V16C16,17.4 15.4,18 14.8,18H9.2C8.6,18 8,17.4 8,16V13C8,12.4 8.6,11.5 9.2,11.5V10C9.2,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.5,8.7 10.5,10V11.5H13.5V10C13.5,8.7 12.8,8.2 12,8.2Z"/>
                        </svg>
                        SSL Secured
                    </div>
                    <div class="security-badge">
                        <svg viewBox="0 0 24 24">
                            <path d="M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1Z"/>
                        </svg>
                        ISO 27001
                    </div>
                    <div class="security-badge">
                        <svg viewBox="0 0 24 24">
                            <path d="M9,10V12H7V10A5,5 0 0,1 12,5A5,5 0 0,1 17,10V12H15V10A3,3 0 0,0 12,7A3,3 0 0,0 9,10M6,13A2,2 0 0,1 8,11H16A2,2 0 0,1 18,13V19A2,2 0 0,1 16,21H8A2,2 0 0,1 6,19V13Z"/>
                        </svg>
                        GDPR Compliant
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Comprehensive Securitization & Financial Markets Data
        const marketData = {
            // Government Bonds & Risk-Free Rates
            'US10Y': { name: 'US 10Y Treasury', value: 467, change24h: 3, change7d: -5, change30d: 15, unit: 'bps' },
            'UK10Y': { name: 'UK 10Y Gilt', value: 421, change24h: -2, change7d: 8, change30d: -12, unit: 'bps' },
            'DE10Y': { name: 'German 10Y Bund', value: 245, change24h: 1, change7d: -12, change30d: 8, unit: 'bps' },
            'US5Y': { name: 'US 5Y Treasury', value: 434, change24h: 2, change7d: -3, change30d: 12, unit: 'bps' },
            'US2Y': { name: 'US 2Y Treasury', value: 489, change24h: 1, change7d: -2, change30d: 8, unit: 'bps' },
            
            // Central Bank Rates & Funding Costs
            'FED': { name: 'Fed Funds Rate', value: 550, change24h: 0, change7d: 0, change30d: 25, unit: 'bps' },
            'BOE': { name: 'Bank of England', value: 525, change24h: 0, change7d: 0, change30d: 0, unit: 'bps' },
            'ECB': { name: 'ECB Deposit Rate', value: 400, change24h: 0, change7d: 0, change30d: -25, unit: 'bps' },
            'BOJ': { name: 'Bank of Japan', value: 25, change24h: 0, change7d: 0, change30d: 25, unit: 'bps' },
            
            // Reference Rates for Securitization
            'SOFR': { name: 'SOFR', value: 532, change24h: -1, change7d: 2, change30d: 18, unit: 'bps' },
            'SONIA': { name: 'SONIA', value: 518, change24h: 0, change7d: 1, change30d: 5, unit: 'bps' },
            'ESTR': { name: 'ESTR', value: 388, change24h: 0, change7d: -1, change30d: -15, unit: 'bps' },
            'TONAR': { name: 'TONAR', value: 23, change24h: 0, change7d: 0, change30d: 2, unit: 'bps' },
            'LIBOR3M': { name: 'USD LIBOR 3M', value: 558, change24h: -2, change7d: 3, change30d: 15, unit: 'bps' },
            
            // Credit & Securitization Spreads
            'IG_SPREAD': { name: 'IG Credit Spread', value: 145, change24h: -2, change7d: 5, change30d: -8, unit: 'bps' },
            'HY_SPREAD': { name: 'HY Credit Spread', value: 425, change24h: 8, change7d: -15, change30d: 25, unit: 'bps' },
            'CMBS_AAA': { name: 'CMBS AAA Spread', value: 145, change24h: -2, change7d: 3, change30d: -5, unit: 'bps' },
            'CMBS_BBB': { name: 'CMBS BBB Spread', value: 285, change24h: 3, change7d: -8, change30d: 12, unit: 'bps' },
            'RMBS_AAA': { name: 'RMBS AAA Spread', value: 125, change24h: -1, change7d: 2, change30d: -3, unit: 'bps' },
            'ABS_AUTO': { name: 'Auto ABS AAA', value: 95, change24h: 1, change7d: -2, change30d: 5, unit: 'bps' },
            'ABS_CC': { name: 'Credit Card ABS', value: 165, change24h: 2, change7d: -4, change30d: 8, unit: 'bps' },
            'CLO_AAA': { name: 'CLO AAA Spread', value: 175, change24h: -3, change7d: 6, change30d: -10, unit: 'bps' },
            'CLO_BB': { name: 'CLO BB Spread', value: 725, change24h: 15, change7d: -25, change30d: 45, unit: 'bps' },
            'CDO_INDEX': { name: 'CDO Index', value: 245, change24h: 5, change7d: -12, change30d: 18, unit: 'bps' },
            
            // Structured Product Indices
            'ABX_AAA': { name: 'ABX AAA Index', value: 9845, change24h: 12, change7d: -34, change30d: 67, unit: 'pts' },
            'CMBX_AAA': { name: 'CMBX AAA Index', value: 9678, change24h: -8, change7d: 25, change30d: -45, unit: 'pts' },
            'LCDX': { name: 'LCDX Index', value: 9912, change24h: 5, change7d: -15, change30d: 28, unit: 'pts' },
            'MCDX': { name: 'MCDX Index', value: 9834, change24h: -3, change7d: 18, change30d: -22, unit: 'pts' },
            
            // Repo & Funding Markets
            'GC_REPO': { name: 'GC Repo Rate', value: 525, change24h: 0, change7d: 1, change30d: 15, unit: 'bps' },
            'TED_SPREAD': { name: 'TED Spread', value: 45, change24h: 1, change7d: -2, change30d: 5, unit: 'bps' },
            'LIBOR_OIS': { name: 'LIBOR-OIS Spread', value: 35, change24h: 0, change7d: 1, change30d: -3, unit: 'bps' },
            'CP_AA': { name: 'Commercial Paper AA', value: 545, change24h: -1, change7d: 3, change30d: 12, unit: 'bps' },
            
            // FX Rates (Critical for Cross-Border Deals)
            'GBPUSD': { name: 'GBP/USD', value: 12745, change24h: -23, change7d: 156, change30d: -234, unit: 'pips' },
            'EURUSD': { name: 'EUR/USD', value: 10842, change24h: 12, change7d: -89, change30d: 145, unit: 'pips' },
            'USDJPY': { name: 'USD/JPY', value: 14975, change24h: 45, change7d: -123, change30d: 567, unit: 'pips' },
            'EURGBP': { name: 'EUR/GBP', value: 8508, change24h: 34, change7d: -201, change30d: 89, unit: 'pips' },
            
            // Credit Default Swaps
            'CDX_IG': { name: 'CDX IG 5Y', value: 67, change24h: -1, change7d: 3, change30d: -5, unit: 'bps' },
            'CDX_HY': { name: 'CDX HY 5Y', value: 425, change24h: 8, change7d: -15, change30d: 25, unit: 'bps' },
            'ITRAXX_EUR': { name: 'iTraxx Europe', value: 58, change24h: 1, change7d: -2, change30d: 4, unit: 'bps' },
            'ITRAXX_XOVER': { name: 'iTraxx Crossover', value: 385, change24h: 12, change7d: -18, change30d: 35, unit: 'bps' },
            
            // Volatility & Risk Metrics
            'VIX': { name: 'VIX', value: 1845, change24h: -67, change7d: 234, change30d: -123, unit: 'pts' },
            'MOVE_INDEX': { name: 'MOVE Index', value: 11245, change24h: 34, change7d: -87, change30d: 156, unit: 'pts' },
            'SKEW': { name: 'CBOE SKEW', value: 14567, change24h: 23, change7d: -45, change30d: 78, unit: 'pts' },
            
            // Equity Indices (for Hybrid Structures)
            'SPX': { name: 'S&P 500', value: 456789, change24h: 2345, change7d: -6723, change30d: 12456, unit: 'pts' },
            'UKX': { name: 'FTSE 100', value: 754321, change24h: -1567, change7d: 4589, change30d: -2345, unit: 'pts' },
            'DAX': { name: 'DAX', value: 1634567, change24h: 234, change7d: -567, change30d: 1234, unit: 'pts' },
            'NIKKEI': { name: 'Nikkei 225', value: 3234567, change24h: 456, change7d: -789, change30d: 1567, unit: 'pts' },
            
            // Commodities (for Commodity-Backed Securities)
            'GOLD': { name: 'Gold', value: 203450, change24h: -575, change7d: 2340, change30d: -1234, unit: 'pts' },
            'OIL_WTI': { name: 'WTI Crude', value: 7234, change24h: 89, change7d: -156, change30d: 345, unit: 'pts' },
            'OIL_BRENT': { name: 'Brent Crude', value: 7834, change24h: 123, change7d: -267, change30d: 456, unit: 'pts' },
            'SILVER': { name: 'Silver', value: 2456, change24h: -34, change7d: 78, change30d: -123, unit: 'pts' },
            'COPPER': { name: 'Copper', value: 89345, change24h: 234, change7d: -456, change30d: 678, unit: 'pts' }
        };

        // Create organized financial ticker content by sections
        function createFinancialTicker() {
            const ticker = document.getElementById('financialTicker');
            let tickerContent = '';
            
            // Define data sections for better organization
            const sections = {
                'BONDS': ['US10Y', 'UK10Y', 'DE10Y', 'US5Y', 'US2Y'],
                'CENTRAL BANK RATES': ['FED', 'BOE', 'ECB', 'BOJ'],
                'REFERENCE RATES': ['SOFR', 'SONIA', 'ESTR', 'TONAR', 'LIBOR3M'],
                'CREDIT SPREADS': ['IG_SPREAD', 'HY_SPREAD', 'CDX_IG', 'CDX_HY', 'ITRAXX_EUR'],
                'SECURITIZATION': ['CMBS_AAA', 'CMBS_BBB', 'RMBS_AAA', 'ABS_AUTO', 'ABS_CC', 'CLO_AAA', 'CLO_BB'],
                'STRUCTURED INDICES': ['ABX_AAA', 'CMBX_AAA', 'LCDX', 'MCDX'],
                'FX RATES': ['GBPUSD', 'EURUSD', 'USDJPY', 'EURGBP'],
                'FUNDING MARKETS': ['GC_REPO', 'TED_SPREAD', 'LIBOR_OIS', 'CP_AA'],
                'VOLATILITY': ['VIX', 'MOVE_INDEX', 'SKEW'],
                'EQUITIES': ['SPX', 'UKX', 'DAX', 'NIKKEI'],
                'COMMODITIES': ['GOLD', 'OIL_WTI', 'OIL_BRENT', 'SILVER', 'COPPER']
            };
            
            // Create multiple rounds for continuous flow
            for (let round = 0; round < 3; round++) {
                Object.entries(sections).forEach(([sectionName, symbols]) => {
                    // Add section header
                    tickerContent += `
                        <div class="ticker-section-header">
                            ${sectionName}
                        </div>
                        <span class="ticker-separator">●</span>
                    `;
                    
                    // Add symbols in this section
                    symbols.forEach(symbol => {
                        const data = marketData[symbol];
                        if (!data) return;
                        
                        // Color logic
                        let colorClass = 'neutral';
                        if (data.change24h > 0 && data.change7d > 0) {
                            colorClass = 'positive';
                        } else if (data.change24h < 0 && data.change7d < 0) {
                            colorClass = 'negative';
                        } else if (Math.abs(data.change24h) > Math.abs(data.change7d)) {
                            colorClass = data.change24h > 0 ? 'positive' : 'negative';
                        } else {
                            colorClass = data.change7d > 0 ? 'positive' : 'negative';
                        }
                        
                        const change24hSign = data.change24h > 0 ? '+' : '';
                        const change7dSign = data.change7d > 0 ? '+' : '';
                        const change30dSign = data.change30d > 0 ? '+' : '';
                        
                        const change24hColor = data.change24h > 0 ? 'color: var(--market-green)' : data.change24h < 0 ? 'color: var(--market-red)' : 'color: var(--amber-yellow)';
                        const change7dColor = data.change7d > 0 ? 'color: var(--market-green)' : data.change7d < 0 ? 'color: var(--market-red)' : 'color: var(--amber-yellow)';
                        const change30dColor = data.change30d > 0 ? 'color: var(--market-green)' : data.change30d < 0 ? 'color: var(--market-red)' : 'color: var(--amber-yellow)';
                        
                        tickerContent += `
                            <div class="ticker-item ${colorClass}">
                                <span class="ticker-symbol">${symbol}:</span>
                                <span class="ticker-value">${data.value}${data.unit}</span>
                                <span style="margin: 0 4px; color: var(--silver-mist);">24h</span>
                                <span style="${change24hColor}">${change24hSign}${data.change24h}${data.unit}</span>
                                <span style="margin: 0 4px; color: var(--silver-mist);">7d</span>
                                <span style="${change7dColor}">${change7dSign}${data.change7d}${data.unit}</span>
                                <span style="margin: 0 4px; color: var(--silver-mist);">30d</span>
                                <span style="${change30dColor}">${change30dSign}${data.change30d}${data.unit}</span>
                            </div>
                            <span class="ticker-separator">●</span>
                        `;
                    });
                    
                    // Add extra separator between sections
                    tickerContent += `<span class="ticker-separator" style="margin: 0 var(--space-6);">||</span>`;
                });
                
                // Add timestamp separator between rounds
                if (round < 2) {
                    const timestamp = new Date().toLocaleTimeString('en-GB', {
                        timeZone: 'GMT',
                        hour12: false
                    });
                    tickerContent += `
                        <div class="ticker-item" style="color: var(--platinum-gold); font-weight: 700; font-size: 1.2rem;">
                            <span>GMT ${timestamp}</span>
                        </div>
                        <span class="ticker-separator" style="margin: 0 var(--space-8);">●●●</span>
                    `;
                }
            }
            
            ticker.innerHTML = tickerContent;
        }

        // Update market data with realistic fluctuations
        function updateMarketData() {
            Object.keys(marketData).forEach(symbol => {
                const data = marketData[symbol];
                
                // Small random fluctuation
                const fluctuation = (Math.random() - 0.5) * 0.002; // 0.2% max change
                data.value = parseFloat((data.value * (1 + fluctuation)).toFixed(4));
                
                // Update 24h change
                const change = (Math.random() - 0.5) * 0.001; // Small change
                data.change24h = parseFloat((data.change24h + change).toFixed(4));
                
                // Update 7d change occasionally
                if (Math.random() < 0.1) { // 10% chance
                    const change7d = (Math.random() - 0.5) * 2;
                    data.change7d = parseFloat((data.change7d + change7d).toFixed(0));
                }
                
                // Update 30d change rarely
                if (Math.random() < 0.05) { // 5% chance
                    const change30d = (Math.random() - 0.5) * 5;
                    data.change30d = parseFloat((data.change30d + change30d).toFixed(0));
                }
            });
            
            // Recreate ticker with updated data
            createFinancialTicker();
        }

        // Executive Navigation System
        document.querySelectorAll('.nav-control').forEach(control => {
            control.addEventListener('click', () => {
                // Clear active states
                document.querySelectorAll('.nav-control').forEach(c => c.classList.remove('active'));
                document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                
                // Set active states
                control.classList.add('active');
                const targetSection = control.dataset.target + '-section';
                document.getElementById(targetSection).classList.add('active');
            });
        });

        // Executive Registration Management
        let registrationAttempted = localStorage.getItem('atlasnexus_executive_registration');
        let registrationTime = localStorage.getItem('atlasnexus_registration_timestamp');

        if (registrationAttempted && registrationTime) {
            const attemptTime = new Date(registrationTime);
            const currentTime = new Date();
            const hoursPassed = (currentTime - attemptTime) / (1000 * 60 * 60);
            
            if (hoursPassed < 1) {
                document.getElementById('registrationStatus').style.display = 'block';
                document.getElementById('registrationForm').style.display = 'none';
            }
        }

        // Executive Form Handling
        document.getElementById('accessForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Save credentials before processing
            saveCredentials();
            
            showExecutiveLoading(this);
            
            // Check if this is the temporary user
            const emailField = this.querySelector('input[name="email"]');
            const passwordField = this.querySelector('input[name="password"]');
            
            // Check for our authorized credentials
            if (emailField.value.toLowerCase() === 'spikemaz8@aol.com' && passwordField.value === 'SpikeMaz') {
                // For authorized user, submit form to server for proper authentication
                setTimeout(() => {
                    this.submit();
                }, 1000);
                return;
            }
            
            // For other users, also submit form
            setTimeout(() => {
                this.submit();
            }, 1500);
        });

        document.getElementById('registrationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            showExecutiveLoading(this);
            
            localStorage.setItem('atlasnexus_executive_registration', 'true');
            localStorage.setItem('atlasnexus_registration_timestamp', new Date().toISOString());
            
            setTimeout(() => {
                this.submit();
            }, 1500);
        });

        // Executive Verification Timer
        let executiveTimer;
        function startExecutiveTimer() {
            let timeLeft = 15 * 60; // 15 minutes
            
            executiveTimer = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                
                const timerElement = document.getElementById('codeTimer');
                if (timerElement) {
                    timerElement.textContent = 
                        minutes.toString().padStart(2, '0') + ':' + seconds.toString().padStart(2, '0');
                }
                
                if (timeLeft <= 0) {
                    clearInterval(executiveTimer);
                    if (timerElement) timerElement.textContent = 'EXPIRED';
                    document.querySelector('.verification-code-field').disabled = true;
                }
                
                timeLeft--;
            }, 1000);
        }

        function requestNewCode() {
            clearInterval(executiveTimer);
            const codeInput = document.querySelector('.verification-code-field');
            if (codeInput) {
                codeInput.disabled = false;
                codeInput.value = '';
            }
            startExecutiveTimer();
        }

        function goBackToLogin() {
            // Clear timer
            clearInterval(executiveTimer);
            
            // Hide verification centre
            document.getElementById('verificationCentre').style.display = 'none';
            
            // Show login form
            document.getElementById('accessForm').style.display = 'block';
            
            // Clear form fields
            const emailField = document.querySelector('input[name="email"]');
            const passwordField = document.querySelector('input[name="password"]');
            const codeField = document.querySelector('.verification-code-field');
            
            if (emailField) emailField.value = '';
            if (passwordField) passwordField.value = '';
            if (codeField) codeField.value = '';
            
            // Focus on email field
            if (emailField) emailField.focus();
        }

        // Auto-submit verification
        document.querySelector('.verification-code-field')?.addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase();
            if (e.target.value.length === 6) {
                setTimeout(() => {
                    document.getElementById('verificationForm').submit();
                }, 1000);
            }
        });

        // Executive Session Management
        let executiveSession;
        let sessionWarning = false;

        function resetExecutiveSession() {
            clearTimeout(executiveSession);
            sessionWarning = false;
            
            executiveSession = setTimeout(() => {
                if (!sessionWarning) {
                    sessionWarning = true;
                    
                    const warningAlert = document.createElement('div');
                    warningAlert.className = 'executive-alert alert-warning';
                    warningAlert.innerHTML = 'Executive session expires in 5 minutes due to inactivity';
                    document.querySelector('.institutional-container').insertBefore(
                        warningAlert, 
                        document.querySelector('.access-portal')
                    );
                    
                    // Removed automatic redirect - let user stay on page
                }
            }, 25 * 60 * 1000);
        }

        // Executive Loading States
        function showExecutiveLoading(form) {
            const command = form.querySelector('.action-command');
            const originalContent = command.innerHTML;
            
            command.disabled = true;
            command.classList.add('command-loading');
            command.innerHTML = `
                <div class="loading-spinner"></div>
                Processing...
            `;
            
            command.dataset.originalContent = originalContent;
        }

        // Ticker Drag Functionality
        let isDragging = false;
        let startX = 0;
        // Navigation Toggle Functionality
        function toggleNavigation() {
            const nav = document.getElementById('toolkitNav');
            const showBtn = document.getElementById('showNavBtn');
            
            if (nav.classList.contains('hidden')) {
                // Show navigation
                nav.classList.remove('hidden');
                showBtn.classList.remove('visible');
            } else {
                // Hide navigation
                nav.classList.add('hidden');
                showBtn.classList.add('visible');
            }
        }
        
        // Navigation Link Functions
        function navigateToLogin() {
            // Check if user is logged in
            if (isUserLoggedIn()) {
                // Show user menu or profile
                showUserMenu();
            } else {
                // Navigate to login section
                document.querySelector('[data-target="access"]').click();
                const loginSection = document.getElementById('access-section');
                if (loginSection) {
                    loginSection.scrollIntoView({ behavior: 'smooth' });
                }
            }
        }
        
        function openMarketUpdates() {
            // Always redirect to market updates page - it handles access control internally
            window.location.href = '/market-updates';
        }
        
        function openDataTools() {
            if (isUserLoggedIn()) {
                window.open('/data-tools', '_blank');
            } else {
                showLoginPrompt('Data Tools');
            }
        }
        
        function openAnalytics() {
            if (isUserLoggedIn()) {
                window.open('/analytics', '_blank');
            } else {
                showLoginPrompt('Analytics');
            }
        }
        
        function openRiskManagement() {
            if (isUserLoggedIn()) {
                window.open('/risk-management', '_blank');
            } else {
                showLoginPrompt('Risk Management');
            }
        }
        
        function openPortfolio() {
            if (isUserLoggedIn()) {
                window.open('/portfolio', '_blank');
            } else {
                showLoginPrompt('Portfolio');
            }
        }
        
        function openCompliance() {
            if (isUserLoggedIn()) {
                window.open('/compliance', '_blank');
            } else {
                showLoginPrompt('Compliance');
            }
        }
        
        function openSettings() {
            if (isUserLoggedIn()) {
                window.open('/settings', '_blank');
            } else {
                showLoginPrompt('Settings');
            }
        }
        
        // Helper Functions
        function isUserLoggedIn() {
            // Check session or token
            return false; // For now, always show login
        }
        
        function showUserMenu() {
            alert('User menu functionality coming soon!');
        }
        
        function showMarketPreview() {
            alert('Market Updates Preview:\n\nLimited data available. Please login for full access.\n\nClick Login to access comprehensive market intelligence.');
        }
        
        function showLoginPrompt(feature) {
            if (confirm(`${feature} requires login access.\n\nWould you like to login now?`)) {
                navigateToLogin();
            }
        }
        
        // Help Tooltip Functionality
        function toggleHelpTooltip() {
            const tooltip = document.getElementById('helpTooltip');
            tooltip.classList.toggle('show');
        }
        
        // Close help tooltip when clicking outside
        document.addEventListener('click', function(event) {
            const helpButton = document.getElementById('helpButton');
            const helpTooltip = document.getElementById('helpTooltip');
            
            if (!helpButton.contains(event.target) && !helpTooltip.contains(event.target)) {
                helpTooltip.classList.remove('show');
            }
        });
        
        // Initialize navigation on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Update login section based on user state
            updateLoginSection();
        });
        
        function updateLoginSection() {
            const loginSection = document.getElementById('loginSection');
            if (isUserLoggedIn()) {
                // Show user info with expiry progress
                loginSection.innerHTML = `
                    <div class="user-section">
                        <div class="user-info">
                            <div class="user-name">John Doe</div>
                            <div class="password-expiry">
                                <span class="expiry-text">15 days left</span>
                                <div class="expiry-bar">
                                    <div class="expiry-progress" style="width: 50%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            // Otherwise keep the current login link
        }

        let currentTranslate = 0;
        let previousTranslate = 0;
        let tickerContainer = null;
        let originalAnimation = '';

        function initializeTickerDrag() {
            tickerContainer = document.getElementById('financialTicker');
            if (!tickerContainer) return;

            // Store original animation
            originalAnimation = tickerContainer.style.animation || 'ticker-scroll 1800s linear infinite';

            // Mouse events
            tickerContainer.addEventListener('mousedown', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('mouseleave', endDrag);

            // Touch events for mobile
            tickerContainer.addEventListener('touchstart', startDrag, { passive: false });
            document.addEventListener('touchmove', drag, { passive: false });
            document.addEventListener('touchend', endDrag);
            document.addEventListener('touchcancel', endDrag);

            // Prevent context menu on right click
            tickerContainer.addEventListener('contextmenu', (e) => e.preventDefault());
        }

        function startDrag(e) {
            e.preventDefault();
            
            isDragging = true;
            startX = getPositionX(e);
            
            // Pause the animation and get current position
            tickerContainer.style.animationPlayState = 'paused';
            
            // Get current computed transform
            const style = window.getComputedStyle(tickerContainer);
            let matrix;
            try {
                matrix = new WebKitCSSMatrix(style.transform);
            } catch (error) {
                // Fallback for browsers that don't support WebKitCSSMatrix
                const transformValue = style.transform;
                if (transformValue && transformValue !== 'none') {
                    const matches = transformValue.match(/translateX\(([^)]+)\)/);
                    previousTranslate = matches ? parseFloat(matches[1]) : 0;
                } else {
                    previousTranslate = 0;
                }
                matrix = { m41: previousTranslate };
            }
            
            previousTranslate = matrix.m41;
            currentTranslate = previousTranslate;
            
            tickerContainer.classList.add('dragging');
        }

        function drag(e) {
            if (!isDragging) return;
            
            e.preventDefault();
            
            const currentPosition = getPositionX(e);
            const diff = currentPosition - startX;
            currentTranslate = previousTranslate + diff;
            
            // Apply transform immediately with !important to override animation
            tickerContainer.style.setProperty('transform', `translateX(${currentTranslate}px)`, 'important');
            tickerContainer.style.setProperty('animation-play-state', 'paused', 'important');
        }

        function endDrag() {
            if (!isDragging) return;
            
            isDragging = false;
            
            // Remove dragging state
            tickerContainer.classList.remove('dragging');
            
            // Get the exact current position where user released
            const exactPosition = currentTranslate;
            
            // Keep the ticker at the exact release position for 2 seconds
            tickerContainer.style.animation = 'none';
            tickerContainer.style.transform = `translateX(${exactPosition}px)`;
            
            // Wait 2 seconds, then start smooth continuation
            setTimeout(() => {
                // Calculate the remaining distance to scroll
                const tickerWidth = tickerContainer.scrollWidth;
                const remainingDistance = tickerWidth + exactPosition; // Distance to complete the cycle
                
                // Calculate speed: we want to maintain the same speed as the original animation
                // Original animation: tickerWidth pixels in 1800 seconds
                const pixelsPerSecond = tickerWidth / 1800;
                const remainingDuration = remainingDistance / pixelsPerSecond;
                
                // Create smooth continuation animation from current position
                const newKeyframes = `
                    @keyframes ticker-continue {
                        0% { transform: translateX(${exactPosition}px); }
                        100% { transform: translateX(-${tickerWidth}px); }
                    }
                `;
                
                // Remove existing resume style if any
                const existingStyle = document.getElementById('ticker-resume-style');
                if (existingStyle) existingStyle.remove();
                
                // Add new keyframes
                const style = document.createElement('style');
                style.id = 'ticker-resume-style';
                style.textContent = newKeyframes;
                document.head.appendChild(style);
                
                // Start the continuation animation
                tickerContainer.style.animation = `ticker-continue ${remainingDuration}s linear infinite`;
                
                // After this cycle, return to normal
                setTimeout(() => {
                    tickerContainer.style.animation = originalAnimation;
                    const tempStyle = document.getElementById('ticker-resume-style');
                    if (tempStyle) tempStyle.remove();
                }, remainingDuration * 1000);
                
            }, 2000); // 2 second pause starts when you release
        }

        function getPositionX(e) {
            return e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
        }

        // Credential Memory Management
        function loadSavedCredentials() {
            const savedEmail = localStorage.getItem('atlasnexus_email');
            const savedPassword = localStorage.getItem('atlasnexus_password');
            const rememberChecked = localStorage.getItem('atlasnexus_remember') === 'true';
            
            if (savedEmail && document.getElementById('emailField')) {
                document.getElementById('emailField').value = savedEmail;
            }
            if (savedPassword && document.getElementById('passwordField') && rememberChecked) {
                document.getElementById('passwordField').value = savedPassword;
            }
            if (document.getElementById('rememberCredentials')) {
                document.getElementById('rememberCredentials').checked = rememberChecked;
            }
        }
        
        function saveCredentials() {
            const emailField = document.getElementById('emailField');
            const passwordField = document.getElementById('passwordField');
            const rememberCheckbox = document.getElementById('rememberCredentials');
            
            if (rememberCheckbox && rememberCheckbox.checked) {
                if (emailField) localStorage.setItem('atlasnexus_email', emailField.value);
                if (passwordField) localStorage.setItem('atlasnexus_password', passwordField.value);
                localStorage.setItem('atlasnexus_remember', 'true');
            } else {
                // Clear saved credentials if not remembering
                localStorage.removeItem('atlasnexus_email');
                localStorage.removeItem('atlasnexus_password');
                localStorage.removeItem('atlasnexus_remember');
            }
        }
        
        // Clear credentials when remember is unchecked
        function handleRememberChange() {
            const rememberCheckbox = document.getElementById('rememberCredentials');
            if (rememberCheckbox && !rememberCheckbox.checked) {
                localStorage.removeItem('atlasnexus_password');
                localStorage.setItem('atlasnexus_remember', 'false');
            }
        }

        
        function fillAddressFields(place, type) {
            if (!place.address_components) return;
            
            // Initialize components
            let streetNumber = '';
            let route = '';
            let locality = '';
            let postalCode = '';
            let country = '';
            
            // Parse address components
            for (let component of place.address_components) {
                const componentType = component.types[0];
                
                switch (componentType) {
                    case 'street_number':
                        streetNumber = component.long_name;
                        break;
                    case 'route':
                        route = component.long_name;
                        break;
                    case 'locality':
                    case 'postal_town':
                    case 'administrative_area_level_2':
                        locality = component.long_name;
                        break;
                    case 'postal_code':
                        postalCode = component.long_name;
                        break;
                    case 'country':
                        country = component.long_name;
                        break;
                }
            }
            
            // Construct full street address
            const fullStreetAddress = `${streetNumber} ${route}`.trim();
            
            // Fill the appropriate fields
            const prefix = type; // 'personal' or 'business'
            
            // Update street address field
            const streetField = document.getElementById(`${prefix}_street_autocomplete`);
            if (streetField && fullStreetAddress) {
                streetField.value = fullStreetAddress;
                
                // Add visual feedback
                streetField.style.borderColor = 'var(--market-green)';
                setTimeout(() => {
                    streetField.style.borderColor = '';
                }, 2000);
            }
            
            // Update city field
            const cityField = document.getElementById(`${prefix}_city`);
            if (cityField && locality) {
                cityField.value = locality;
                cityField.style.borderColor = 'var(--market-green)';
                setTimeout(() => {
                    cityField.style.borderColor = '';
                }, 2000);
            }
            
            // Update postcode field
            const postcodeField = document.getElementById(`${prefix}_postcode`);
            if (postcodeField && postalCode) {
                postcodeField.value = postalCode;
                postcodeField.style.borderColor = 'var(--market-green)';
                setTimeout(() => {
                    postcodeField.style.borderColor = '';
                }, 2000);
            }
            
            // Update country field
            const countryField = document.getElementById(`${prefix}_country`);
            if (countryField && country) {
                // Try to match the country name to the select options
                for (let option of countryField.options) {
                    if (option.value.toLowerCase().includes(country.toLowerCase()) || 
                        country.toLowerCase().includes(option.value.toLowerCase())) {
                        countryField.value = option.value;
                        countryField.style.borderColor = 'var(--market-green)';
                        setTimeout(() => {
                            countryField.style.borderColor = '';
                        }, 2000);
                        break;
                    }
                }
            }
            
            // Show success message
            showToast(`${type === 'personal' ? 'Residential' : 'Company'} address auto-populated successfully!`, 'success');
        }
        
        // Fallback postcode lookup for UK addresses (basic functionality without Google API)
        function setupPostcodeLookup() {
            // Add event listeners to postcode fields for basic UK postcode validation
            const postcodeFields = ['personal_postcode', 'business_postcode'];
            
            postcodeFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('blur', function() {
                        validateUKPostcode(this);
                    });
                }
            });
        }
        
        function validateUKPostcode(field) {
            const postcode = field.value.trim().toUpperCase();
            const ukPostcodeRegex = /^([A-Z]{1,2}\d{1,2}[A-Z]?)\s*(\d[A-Z]{2})$/;
            
            if (postcode && ukPostcodeRegex.test(postcode)) {
                // Format the postcode correctly
                const match = postcode.match(ukPostcodeRegex);
                if (match) {
                    const formattedPostcode = `${match[1]} ${match[2]}`;
                    field.value = formattedPostcode;
                    field.style.borderColor = 'var(--market-green)';
                    setTimeout(() => {
                        field.style.borderColor = '';
                    }, 2000);
                }
            } else if (postcode) {
                // Invalid postcode format
                field.style.borderColor = 'var(--market-red)';
                setTimeout(() => {
                    field.style.borderColor = '';
                }, 3000);
            }
        }

        // Initialise Executive Systems
        document.addEventListener('DOMContentLoaded', () => {
            createFinancialTicker();
            updateMarketData();
            setInterval(updateMarketData, 15000); // Update every 15 seconds for more dynamic ticker
            
            // Initialize market preview functionality
            initializeMarketPreview();
            
            // Initialize ticker drag functionality
            setTimeout(initializeTickerDrag, 100); // Small delay to ensure ticker is created
            
            // Initialize address autocomplete
            setupAddressAutocomplete();
            
            resetExecutiveSession();
            document.addEventListener('click', resetExecutiveSession);
            document.addEventListener('keypress', resetExecutiveSession);
            
            // Load saved credentials
            loadSavedCredentials();
            
            // Add event listener for remember checkbox
            const rememberCheckbox = document.getElementById('rememberCredentials');
            if (rememberCheckbox) {
                rememberCheckbox.addEventListener('change', handleRememberChange);
            }
            
            // Initialize Google Places autocomplete if available, otherwise use fallback
            setTimeout(() => {
                if (typeof google !== 'undefined' && google.maps && google.maps.places) {
                    setupAddressAutocomplete();
                } else {
                    // Fallback: Basic postcode validation
                    setupPostcodeLookup();
                }
            }, 1000);
            
            // Show verification if needed
            if (window.location.search.includes('show_verification=true')) {
                document.getElementById('verificationCentre').style.display = 'block';
                startExecutiveTimer();
            }
        });
        
        // Companies House Search Function
        function searchCompaniesHouse() {
            console.log('searchCompaniesHouse function called'); // Debug log
            
            const searchInput = document.getElementById('companySearchInput');
            if (!searchInput) {
                console.error('Company search input not found');
                alert('Error: Search input not found. Please refresh the page and try again.');
                return;
            }
            
            const companyName = searchInput.value.trim();
            console.log('Company name:', companyName); // Debug log
            
            if (companyName === '') {
                alert('Please enter a company name to search for');
                searchInput.focus();
                return;
            }
            
            try {
                // Construct the Companies House search URL
                const searchQuery = encodeURIComponent(companyName);
                const companiesHouseURL = `https://find-and-update.company-information.service.gov.uk/search/companies?q=${searchQuery}`;
                
                console.log('Opening URL:', companiesHouseURL); // Debug log
                
                // Try multiple methods to open the new tab
                const newWindow = window.open(companiesHouseURL, '_blank', 'noopener,noreferrer');
                
                if (!newWindow) {
                    // Fallback if popup is blocked
                    console.log('Popup blocked, trying fallback method');
                    const link = document.createElement('a');
                    link.href = companiesHouseURL;
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Show popup blocker message
                    alert('If the Companies House website didn\'t open, please check your popup blocker settings and try again.');
                }
                
                // Show helpful message
                setTimeout(() => {
                    const helpText = document.createElement('div');
                    helpText.className = 'alert alert-info alert-dismissible fade show mt-2';
                    helpText.innerHTML = `
                        <div class="d-flex align-items-center">
                            <i class="fas fa-lightbulb me-2"></i>
                            <div class="small">
                                <strong>Tip:</strong> Once you find your company on Companies House, copy the company number and registered address back to this form.
                            </div>
                            <button type="button" class="btn-close btn-close-sm ms-auto" data-bs-dismiss="alert"></button>
                        </div>
                    `;
                    
                    const searchContainer = document.querySelector('.companies-house-search');
                    if (searchContainer) {
                        searchContainer.appendChild(helpText);
                        
                        // Auto-remove after 8 seconds
                        setTimeout(() => {
                            if (helpText.parentNode) {
                                helpText.remove();
                            }
                        }, 8000);
                    }
                }, 500);
                
            } catch (error) {
                console.error('Error in searchCompaniesHouse:', error);
                alert('An error occurred while trying to open Companies House. Please try again or visit https://find-and-update.company-information.service.gov.uk/ directly.');
            }
        }
        
        // Allow Enter key to trigger search in company search input
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('companySearchInput');
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        searchCompaniesHouse();
                    }
                });
            }
            
            // Handle registration form submission
            const registrationForm = document.getElementById('registrationForm');
            if (registrationForm) {
                registrationForm.addEventListener('submit', function(e) {
                    handleFormSubmission();
                });
            }
        });
        
        // Form submission handler with loading states
        function handleFormSubmission() {
            const submitBtn = document.getElementById('submitBtn');
            const submitContent = document.getElementById('submitBtnContent');
            const submitLoading = document.getElementById('submitBtnLoading');
            const successMessage = document.getElementById('successMessage');
            
            if (submitBtn) {
                // Show loading state
                submitContent.style.display = 'none';
                submitLoading.style.display = 'inline-flex';
                submitBtn.disabled = true;
                submitBtn.style.opacity = '0.8';
                
                // Add spinning animation if not already present
                if (!document.querySelector('.spinning-animation')) {
                    const style = document.createElement('style');
                    style.className = 'spinning-animation';
                    style.textContent = `
                        .spinning {
                            animation: spin 1s linear infinite;
                        }
                        @keyframes spin {
                            from { transform: rotate(0deg); }
                            to { transform: rotate(360deg); }
                        }
                    `;
                    document.head.appendChild(style);
                }
                
                // Simulate success after form processes (this will be replaced by server response)
                setTimeout(() => {
                    // Show success message
                    if (successMessage) {
                        successMessage.style.display = 'block';
                        successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                    
                    // Keep loading state for a moment
                    setTimeout(() => {
                        submitContent.style.display = 'inline-flex';
                        submitLoading.style.display = 'none';
                        submitBtn.disabled = false;
                        submitBtn.style.opacity = '1';
                        
                        // Change button text to indicate completion
                        if (submitContent.querySelector('svg')) {
                            submitContent.innerHTML = `
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                </svg>
                                Request Submitted
                            `;
                        }
                    }, 1000);
                }, 2000);
            }
        }
        
        // Market Preview Functionality
        function initializeMarketPreview() {
            updateMarketStatus();
            updateDailyInsights();
            updateMarketWidgets();
            
            // Update market status every minute
            setInterval(updateMarketStatus, 60000);
            
            // Update daily insights every hour
            setInterval(updateDailyInsights, 3600000);
            
            // Update market widgets every 30 seconds
            setInterval(updateMarketWidgets, 30000);
        }
        
        function updateMarketStatus() {
            const now = new Date();
            const hour = now.getHours();
            const day = now.getDay();
            const indicator = document.getElementById('marketStatusIndicator');
            const statusText = document.getElementById('marketStatusText');
            
            if (!indicator || !statusText) return;
            
            // Check if markets are open (simplified - weekdays 9:30-16:00 EST)
            const isWeekday = day >= 1 && day <= 5;
            const isMarketHours = hour >= 9 && hour <= 16;
            const isOpen = isWeekday && isMarketHours;
            
            if (isOpen) {
                indicator.style.backgroundColor = '#00ff88';
                statusText.textContent = 'Markets Open';
            } else {
                indicator.style.backgroundColor = '#ff6b6b';
                statusText.textContent = 'Markets Closed';
            }
        }
        
        function updateDailyInsights() {
            const insights = [
                "Federal Reserve maintains hawkish stance amid inflation concerns. Bond yields climbing across the curve.",
                "Technology sector shows resilience with strong earnings reports from major companies this week.",
                "Global supply chain improvements driving down commodity prices and supporting equity markets.",
                "Central bank divergence creating opportunities in foreign exchange markets.",
                "ESG investment flows continue to accelerate, reshaping corporate financing strategies.",
                "Cryptocurrency adoption by institutional investors reaches new milestones this quarter.",
                "Energy transition investments driving infrastructure and green bond issuance.",
                "Emerging markets showing renewed strength following recent policy reforms.",
                "Credit spreads tightening as corporate fundamentals continue to improve.",
                "Real estate markets adjusting to new interest rate environment across regions."
            ];
            
            const today = new Date().getDate();
            const selectedInsight = insights[today % insights.length];
            
            const insightElement = document.querySelector('.insight-text');
            if (insightElement) {
                insightElement.textContent = selectedInsight;
            }
        }
        
        function updateMarketWidgets() {
            // Simulate real-time data updates with small variations
            const widgets = document.querySelectorAll('.market-widget');
            
            widgets.forEach((widget, index) => {
                const valueElement = widget.querySelector('.widget-value');
                const changeElement = widget.querySelector('.widget-change');
                
                if (valueElement && changeElement) {
                    // Generate small random variations
                    const variation = (Math.random() - 0.5) * 0.02; // ±1% variation
                    const isPositive = Math.random() > 0.5;
                    const changeValue = (Math.random() * 2).toFixed(2);
                    
                    // Update change indicator
                    changeElement.textContent = `${isPositive ? '+' : '-'}${changeValue}%`;
                    changeElement.className = `widget-change ${isPositive ? 'positive' : 'negative'}`;
                }
            });
        }
        
        function accessFullMarkets() {
            // Show login prompt overlay
            const overlay = document.createElement('div');
            overlay.className = 'market-login-overlay';
            overlay.innerHTML = `
                <div class="market-login-modal">
                    <div class="modal-header">
                        <h3>Full Market Intelligence Access</h3>
                        <span class="close-modal" onclick="closeMarketModal()">&times;</span>
                    </div>
                    <div class="modal-content">
                        <div class="premium-features">
                            <h4>Unlock Premium Market Intelligence</h4>
                            <ul>
                                <li>✓ Real-time market data and analytics</li>
                                <li>✓ Daily automation and expert commentary</li>
                                <li>✓ Comprehensive sector analysis</li>
                                <li>✓ Custom portfolio tracking</li>
                                <li>✓ Risk management tools</li>
                                <li>✓ Email digest and alerts</li>
                            </ul>
                        </div>
                        <div class="modal-actions">
                            <button class="premium-login-btn" onclick="goToLogin()">
                                Login to Access Full Platform
                            </button>
                            <button class="modal-close-btn" onclick="closeMarketModal()">
                                Continue with Preview
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(overlay);
            overlay.style.display = 'flex';
        }
        
        function closeMarketModal() {
            const overlay = document.querySelector('.market-login-overlay');
            if (overlay) {
                overlay.remove();
            }
        }
        
        function goToLogin() {
            closeMarketModal();
            document.querySelector('[data-target="access"]').click();
        }
    </script>
</body>
</html>